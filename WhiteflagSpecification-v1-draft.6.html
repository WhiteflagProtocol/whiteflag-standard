<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-GB" xml:lang="en-GB">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Whiteflag Protocol Specification</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</head>
<body>
<div id="header">
<h1 class="title">Whiteflag Protocol Specification</h1>
<h1 class="subtitle">Specification for a decentralised protocol to create a trusted messaging network for disaster &amp; conflict zones</h1>
</div>
<table>
<thead>
<tr class="header">
<th align="left">Status</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">version</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">status</td>
<td align="left">DRAFT 6</td>
</tr>
<tr class="odd">
<td align="left">date</td>
<td align="left">28 FEB 2019</td>
</tr>
</tbody>
</table>
<h1 id="introduction">1 Introduction</h1>
<h2 id="background">1.1 Background</h2>
<p>Current armed conflicts are highly complex, because of the sheer number of parties involved: regular military forces, armed groups, peacekeeping forces, neutral parties such as journalists and non-governmental human-rights and aid organisations, civilians, refugees etc. Even though parties are opposing forces, or neutral organisations that do not want to show any affiliation, they do require to quickly and directly communicate to one or more other parties involved in the conflict in different situations.</p>
<p>This is not new. The white flag is the original internationally recognized protective sign of truce or ceasefire, and request for negotiation. A white flag signifies to all that an approaching negotiator is unarmed, with an intent to surrender or a desire to communicate.</p>
<p>This standard for a digital white flag protocol, the Whiteflag Protocol, provides a reliable means for both combatant and neutral parties in conflict zones to digitally communicate pre-defined signs and signals using blockchain technology. These sign and signals can also be used to communicate information about natural and man-made disasters, thus creating shared situational awareness beyond conflicts.</p>
<p>All in all, the protocol forms the basis for a neutral and open network, the Whiteflag Network, for trusted real-time messaging between parties in conflicts and disaster response.</p>
<h2 id="purpose">1.2 Purpose</h2>
<p>The purpose of the Whiteflag Protocol is to provide an open, real-time, trusted communication channel between any or all parties in conflict and disaster zones, without the requirement for a trusted third party or any specific software or system. It is the intention to provide a means of communication to be used that is fast, reliable and accessible by everyone, in addition to internal communications within organisations and in addition to any currently existing but limited communication methods such as flags, signs, registers etc.</p>
<p>The purpose of this document is to describe and define the protocol and the message format of the communication channel for policy makers and specialists to be able to adopt and implement the Whiteflag Protocol.</p>
<h2 id="document-structure">1.3 Document Structure</h2>
<p>Chapter 1 &quot;Introduction&quot; describes this document. Chapter 2 &quot;Overview&quot; defines the scope and gives an overview of the protocol, followed by typical use case examples in Chapter 3 &quot;Use Case Examples&quot;. Chapter 4 &quot;Message Format&quot; provides the detailed messages descriptions, and Chapter 5 &quot;Protocol&quot; the detailed protocol description.</p>
<h2 id="used-terminology">1.4 Used Terminology</h2>
<p>The following phrases in this specification must be interpreted as follows:</p>
<ul>
<li><p>... MUST: indicates that something is mandatory, i.e. an absolute requirement</p></li>
<li><p>... MUST BE ... IF ...: indicates that something is mandatory if some condition is met</p></li>
<li><p>... MUST BE ... WHEN ...: indicates something is mandatory when something becomes true</p></li>
<li><p>... MUST NOT ...: indicates that something is not allowed, i.e. an absolute prohibition</p></li>
<li><p>... MAY ONLY ... IF ...: indicates something is only allowed if some condition is met</p></li>
<li><p>... MAY ...: indicates that something is allowed</p></li>
<li><p>... SHOULD: indicates something is strongly recommended</p></li>
<li><p>... SHOULD NOT: indicates something is strongly not recommended</p></li>
<li><p>... NEED NOT ... / ... NOT REQUIRED : indicates that something is not mandatory</p></li>
</ul>
<p>An overview of definitions of the most important terms used in this document can be found in Annex D.</p>
<h2 id="license-and-usage">1.5 License and Usage</h2>
<p>All persons and organisations that contributed to the initial development of the Whiteflag Protocol did so disinterestedly.</p>
<p>The Whiteflag Protocol specification is dedicated to the public domain under the <a href="http://creativecommons.org/publicdomain/zero/1.0/">Creative Commons CC0-1.0 Universal Public Domain Dedication</a> statement, meaning that to the extent possible under law, the authors and their organisations have waived all copyright and related or neighboring rights to this work, allowing anyone to copy, modify, distribute and implement the work, even for commercial purposes, all without asking permission.</p>
<p>In no way are the patent or trademark rights of any person affected by this dedication to the public domain, nor are the rights that other persons may have in the work or in how the work is used, such as publicity or privacy rights. Unless expressly stated otherwise, the authors and their organisations make no warranties about the work, and disclaim liability for all uses of the work, to the fullest extent permitted by applicable law. When using or citing the work, you should not imply endorsement by the authors or the affirmer.</p>
<p>WARNING: THE USAGE OF SIGNS AND SIGNALS IN THIS SPECIFICATION IS SUBJECT TO LOCAL AND/OR INTERNATIONAL LAWS. Please take note of the following when implementing or using this standard:</p>
<ul>
<li><p>This standard only specifies an additional means of communication for certain signs and signals, and it does not replace any existing standard, regulation or means of communication, whether mandatory or not, including but not limited to physical signs, radio communications, official registers, etc.</p></li>
<li><p>The usage of protective signs is subject to International Humanitarian Law. Misuse of protective signs is a punishable violation under local and international laws.</p></li>
<li><p>The usage of emergency signals may be subject to various regulations and standards, depending on location and context. The misuse of emergency signals, including misuse of the duress functionality, may be a punishable violation under local and international laws.</p></li>
</ul>
<h2 id="configuration-management">1.6 Configuration Management</h2>
<p>It is foreseen that this standard requires updates in the near future as a result of validation testing and to ensure compatibility with emerging distributed computing practices, paradigms and standards. Therefore, for the time being, the standard will remain under configuration control of the authors. Requests and comments may be e-mailed to the authors:</p>
<ul>
<li>T. Schless: <code>tschless (at) acm . org</code></li>
<li>M. Kolenbrander: <code>mkolenbrander (at) acm . org</code></li>
</ul>
<p>In the meantime, a more sustainable process for configuration management of this standard in line with its open character is under consideration.</p>
<h1 id="overview">2 Overview</h1>
<h2 id="design-principles">2.1 Design Principles</h2>
<p>The following principles are the basis for the Whiteflag Protocol:</p>
<ul>
<li>the protocol is based on blockchain technology, but is &quot;blockchain-agnostic&quot;, i.e. independent of any specific blockchain;</li>
<li>the protocol is as free and open as the underlying blockchain and internet technologies are: anyone can join at any time without permission;</li>
<li>the working of the protocol does not rely on any third party, i.e. there is no ownership of the network that is created with the protocol and no dependency on specific software or a system;</li>
<li>the protocol does not have access control, but does provide means of authentication;</li>
<li>the protocol inherits the data integrity and non-repudiation properties of the underlying blockchain(s);</li>
<li>the protocol allows to use encryption for message confidentiality;</li>
<li>the protocol should be compliant with international rules and standards for armed conflicts;</li>
<li>the protocol is kept as simple as possible, to ensure easy access, easy understanding and easy implementation;</li>
<li>the message formats are fixed to ensure interoperability and a common understanding between the communicating parties;</li>
<li>the protocol is extensible to allow functionality to be added with backwards compatibility;</li>
<li>implementation only requires the use of open standards.</li>
</ul>
<h2 id="protocol-stack-and-scope">2.2 Protocol Stack and Scope</h2>
<p>The Whiteflag Protocol works on top of the internet and on one or more blockchains to create a network for trusted communications that can be used by different applications through application programming interfaces.</p>
<p>The protocol stack comprises the following 6 layers, from bottom to top:</p>
<ul>
<li><p>The <em>Connection Layers</em> are to ensure global connectivity. Essentially these are the 7 OSI layers as implemented with the Internet.</p></li>
<li><p>The <em>Blockchain Layer</em> ensures connectivity and interaction with specific blockchains, typically through their APIs.</p></li>
<li><p>The <em>Blockchain Overlay Network Layer</em> is an abstraction for applications using existing blockchains to validate their transactions. In this case, the Whiteflag Network is created as a blockchain overlay network by Whiteflag applications encapsulating Whiteflag messages in blockchain transactions.</p></li>
<li><p>The <em>Decentralised Protocol Layer</em> is a protocol that is not controlled by a single entity. That is exactly what the Whiteflag Protocol and the scope of this specification is.</p></li>
<li><p>The <em>Application Programming Interface (API) layer</em> contains the solutions that allow software to interface with the Whiteflag Protocol. These APIs may provide useful additions to the protocol such as handling, tracking and searching of Whiteflag messages.</p></li>
<li><p>The <em>Application Layer</em> is the part of the stack that comprises the applications that are actually used by the end-users. These might be existing classical applications such as databases in use by various organisations, or newly developed web applications or smartphone apps that can send, receive, filter, analyse messages.</p></li>
</ul>
<h2 id="references">2.3 References</h2>
<h3 id="international-rules-regulations">2.3.1 International Rules &amp; Regulations</h3>
<h4 id="international-humanitarian-law">2.3.1.1 International Humanitarian Law</h4>
<p>A. Convention (IV) respecting the Laws and Customs of War on Land and its annex: Regulations concerning the Laws and Customs of War on Land. The Hague, 18 October 1907.</p>
<p>B. Convention (I) for the Amelioration of the Condition of the Wounded and Sick in Armed Forces in the Field. Geneva, 12 August 1949.</p>
<p>C. Protocol additional to the Geneva Conventions of 12 August 1949, and relating to the Adoption of an Additional Distinctive Emblem (Protocol III), 8 December 2005.</p>
<p>D. Convention (III) relative to the Treatment of Prisoners of War. Geneva, 12 August 1949.</p>
<p>E. Convention (IV) relative to the Protection of Civilian Persons in Time of War. Geneva, 12 August 1949.</p>
<p>F. Protocol Additional to the Geneva Conventions of 12 August 1949, and relating to the Protection of Victims of International Armed Conflicts (Protocol I), 8 June 1977.</p>
<p>G. Convention on the Safety of United Nations and Associated Personnel. New York, 9 December 1994.</p>
<p>H. Treaty on the Protection of Artistic and Scientific Institutions and Historic Monuments (Roerich Pact). Washington, 15 April 1935.</p>
<p>I. The 1954 Hague Convention for the Protection of Cultural Property in the Event of Armed Conflict and its two (1954 and 1999) Protocols, United Nations Educational, Scientific and Cultural Organization (UNESCO).</p>
<h4 id="international-standards">2.3.1.2 International Standards</h4>
<p>J. IMO IA994E International Code of Signals, 2005 Edition.</p>
<p>K. Disaster Category Classification and peril Terminology for Operational Purposes, Centre for Research on the Epidemiology of Disasters (CRED) and Munich Reinsurance Company (Munich RE), October 2009.</p>
<p>L. Economic Infrastructure Common Reporting Standard Codes, Organisation for Economic Cooperation and Development (OECD).</p>
<h3 id="technical-standards">2.3.2 Technical Standards</h3>
<h4 id="communication-and-data-format-standards">2.3.2.1 Communication and Data Format Standards</h4>
<p>M. RFC 3339, Date and Time on the Internet: Timestamps, July 2002, internet: <a href="https://www.ietf.org/rfc/rfc3339.txt" class="uri">https://www.ietf.org/rfc/rfc3339.txt</a></p>
<p>N. RFC 3986, Uniform Resource Identifier (URI): Generic Syntax, January 2005, internet: <a href="https://www.ietf.org/rfc/rfc3986.txt" class="uri">https://www.ietf.org/rfc/rfc3986.txt</a></p>
<p>O. RFC 4627, The application/json Media Type for JavaScript Object Notation (JSON), July 2006, internet: <a href="https://www.ietf.org/rfc/rfc4627.txt" class="uri">https://www.ietf.org/rfc/rfc4627.txt</a></p>
<p>P. RFC 7515, JSON Web Signature (JWS), May 2015, internet: <a href="https://www.ietf.org/rfc/rfc7515.txt" class="uri">https://www.ietf.org/rfc/rfc7515.txt</a></p>
<p>Q. ISO 8601, Date and Time Representation</p>
<p>R. ISO 6709, Standard representation of geographic point location by coordinates</p>
<h4 id="cryptographic-standards">2.3.2.2 Cryptographic Standards</h4>
<p>S. OpenSSL Implementation of the Elliptic Curve Diffie-Hellman (ECDH) algorithm, internet: <a href="https://wiki.openssl.org/index.php?title=Elliptic_Curve_Diffie_Hellman&amp;oldid=1558" class="uri">https://wiki.openssl.org/index.php?title=Elliptic_Curve_Diffie_Hellman&amp;oldid=1558</a></p>
<p>T. OpenSSL Implementation of the Advanced Encryption Standard (AES)</p>
<p>U. RFC 5639, ECC Brainpool Standard Curves &amp; Curve Generation, March 2010, internet: <a href="https://www.ietf.org/rfc/rfc5639.txt" class="uri">https://www.ietf.org/rfc/rfc5639.txt</a></p>
<p>V. RFC 5869, HMAC-based Extract-and-Expand Key Derivation Function (HKDF), internet: <a href="https://www.rfc-editor.org/rfc/rfc5869.txt" class="uri">https://www.rfc-editor.org/rfc/rfc5869.txt</a></p>
<h2 id="high-level-functional-overview">2.4 High-level Functional Overview</h2>
<h3 id="blockchain-and-communication-functionality">2.4.1 Blockchain and Communication Functionality</h3>
<h4 id="general">2.4.1.1 General</h4>
<p>A blockchain is a shared database that maintains a continuously-growing list of ordered records called blocks, each containing a timestamp and a hash-based link to a previous block going all the way back to the first block.</p>
<p>Blockchain networks are open source distributed computing systems with high byzantine fault tolerance: secure by design and inherently resistant to modification of the data; once recorded, the data in a block cannot be altered retroactively.</p>
<p>Therefore, a blockchain can be seen as an open, distributed ledger that can record transactions between parties efficiently and in a verifiable and permanent way. This makes blockchains very suitable for the recording of events and messages.</p>
<p>The Whiteflag Protocol defines the messages for signs and signals used in armed conflicts and for disasters, and it defines how those messages can be sent on, in principle, any blockchain network by encapsulating them in transactions. A messages is recorded in the database when such a transaction (including the encapsulated data) gets included in a new block.</p>
<p>The usage of the Whiteflag Protocol on one or more specific blockchain network(s), establishes what in this specification is called the Whiteflag Messaging Network, or just &quot;the network&quot;, and can be seen as what is sometimes called a <em>Blockchain Overlay Network</em>.</p>
<h4 id="originator-and-account">2.4.1.2 Originator and Account</h4>
<p>The originator is a specific organisation or person that sends Whiteflag Messages on the Whiteflag Network. The originator's identity is established upon initial entry to the network. An originator may use multiple accounts on the blockchain network. Although an account may use multiple (deterministic) addresses, the usage of more than one address by a single account is not recommended for Whiteflag.</p>
<p>It is only required for an originator to provide identity information before sending messages; it is not required to provide identity information to receive messages, as anyone can observe what is happening on the blockchain.</p>
<h4 id="authentication-mechanisms">2.4.1.3 Authentication mechanisms</h4>
<p>An originator must introduce itself on the Whiteflag Network and provide identity information with one or more initial authentication messages. An initial authentication message contains the self-chosen name of the originator, and a method to verify that the originator's blockchain address is under control by the person or organisation the originator claims he is.</p>
<p>Currently, two basic methods of verification are supported by the protocol.</p>
<ol style="list-style-type: decimal">
<li><p>The first method makes use of an internet resource, such as a web site, under control of the originator. The initial authentication message of the originator contains an Uniform Resource Locator (URL) to the internet resource, where the originator posts the corresponding blockchain address, along with its proclaimed name, both signed with a digital signature using the address' secret private key. Anyone can now validate that the blockchain address is under control by the originator by performing a check on the validity of the digitally signed message using the blockchain address' public key. This verification method assumes that the originator is in control of the internet resource specified in the initial authentication message, and can therefore be associated with that internet resource. As a result, the initial trustworthiness of the identity is as strong as the internet resource being used: obviously this differs between an SSL-secured web site of an acclaimed organisation and for instance a pseudonymous social media post. Although an internet site is vulnerable to being compromised and an attacker could alter the authentication data on the internet resource, this will never result in a valid digital signature as long as the private key remains secret.</p></li>
<li><p>The second method uses a pre-shared token. The originator and a receiver exchange a token, which is not known to anybody. The the originator identifies himself by putting a combined hash of the token and the blockchain account in the initial authentication message. The receiver can verify now that the claimed blockchain address actually belongs to the originator who was in prior possession of the token. Note that the secret token itself is not revealed. The originator may do this multiple times with different tokens, different accounts and/or different receivers, and any combination of those.</p></li>
</ol>
<p>The initial authentication can be enhanced by using multiple initial authentication messages, i.e. by combining both verification methods, and also use multiple tokens and URLs. Additionally, the protocol allows other participants to confirm the originator's identity, which is especially useful if those confirming participants have well-established identities.</p>
<p>For blockchains that encourage or require to use a different address for each transaction, deterministic key chains are used to link the authentication message both to the blockchain account as well as to other messages sent by the same originator but with different addresses.</p>
<p>The authentication mechanism is described in detail in 2.4.2.2 Management Messages (initial authentication message) and Joining and Leaving the Whiteflag Network (protocol for initial authentication). After initial authentication, the Whiteflag Protocol utilizes the authentication mechanism of the underlying blockchain.</p>
<p>As means for digital identification on the internet are still evolving, it is anticipated that additional methods will be added in future versions.</p>
<h4 id="communications-security">2.4.1.4 Communications Security</h4>
<p>The Whiteflag Protocol leverages blockchain technology to ensure data integrity, non-repudiation and historical continuity. The underlying blockchain(s) ensure(s) that any message ever sent will be verifiable, unalterable and available to anybody, even to participants that start to use the protocol later in time.</p>
<p>Blockchain networks using the proof-of-work consensus model (Nakamoto consensus) timestamp transactions by hashing them into an ongoing chain of hash-based proof-of-work, forming a record that cannot be changed without redoing the proof-of-work.</p>
<p>The timestamp proves that the data must have existed at the time in order to get into the hash. Each timestamp includes the previous timestamp in its hash, forming a chain, with each additional timestamp reinforcing the ones before it. The hash chain of blocks provides an unchangeable historical record, which is verifiable by anyone.</p>
<p>Nodes can leave and rejoin a blockchain network and thus the Whiteflag Network at will, accepting the proof-of-work chain as validation of what happened while they were gone. Upon rejoining, missing blocks are downloaded, verified and added to the nodes' local copy of the database until it has caught up with the network and is in sync (again).</p>
<h4 id="data-security">2.4.1.5 Data Security</h4>
<p>The Whiteflag Protocol the protocol provides optional message confidentiality using an AES based encryption scheme to encrypt the message contents. This is described in detail in 4.1.4 Encryption.</p>
<p>The encryption scheme allow for both Diffie-Hellman negotiated keys and pre-shared keys. The Whiteflag Protocol specifies the Diffie-Hellman key exchange, but does not specify how pre-shared encryption keys should be managed or distributed. It is between the originator and recipient to agree on a secure key exchange procedure.</p>
<h3 id="message-functionality">2.4.2 Message Functionality</h3>
<h4 id="functional-messages">2.4.2.1 Functional Messages</h4>
<p>The following Functional Messages are specified in this standard. These messages are to send a sign or signal as defined in international standards, and to provide additional information.</p>
<table style="width:100%;">
<colgroup>
<col width="6%" />
<col width="26%" />
<col width="66%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>P</code></td>
<td align="left"><code>ProtectiveSign</code></td>
<td align="left">Sign to mark objects under the protection of international law</td>
</tr>
<tr class="even">
<td align="left"><code>E</code></td>
<td align="left"><code>EmergencySignal</code></td>
<td align="left">Signal to send an emergency signal when in need of assistance</td>
</tr>
<tr class="odd">
<td align="left"><code>D</code></td>
<td align="left"><code>DangerSign</code></td>
<td align="left">Sign to mark a location or area of imminent danger, e.g. an area under attack, land mines, disaster, etc.</td>
</tr>
<tr class="even">
<td align="left"><code>S</code></td>
<td align="left"><code>StatusSignal</code></td>
<td align="left">Signal to provide the status of an object, or specifically for persons: give a proof of life</td>
</tr>
<tr class="odd">
<td align="left"><code>I</code></td>
<td align="left"><code>InfrastructureSign</code></td>
<td align="left">Sign to mark critical infrastructure, e.g. roads, utilities, water treatment, hospitals, power plants etc.</td>
</tr>
<tr class="even">
<td align="left"><code>M</code></td>
<td align="left"><code>MissionSignal</code></td>
<td align="left">Signal to provide information on activities undertaken during a mission</td>
</tr>
<tr class="odd">
<td align="left"><code>Q</code></td>
<td align="left"><code>RequestSignal</code></td>
<td align="left">Signal to perform requests to other parties</td>
</tr>
<tr class="even">
<td align="left"><code>R</code></td>
<td align="left"><code>Resource</code></td>
<td align="left">Message to point to an internet resource</td>
</tr>
<tr class="odd">
<td align="left"><code>F</code></td>
<td align="left"><code>FreeText</code></td>
<td align="left">Message to send a free text string</td>
</tr>
</tbody>
</table>
<p>A specific Functional Message has a single meaning. For example, a Danger Sign is just that: a Danger Sign, which does not imply that the originator is in danger or requires assistance. In such a case, the originator must send an emergency signal.</p>
<p>However, a Functional Message may be related to an earlier Functional Message by referencing it. In this way, sequences of message can be created, e.g. for moving objects (by updating the coordinates of a Protective Sign), or requesting assistance for an object under attack (by sending an Emergency Signal referring to a Status Signal referring to a Danger Sign). Message sequencing is described in detail in 5.4.2. Message Sequences.</p>
<h4 id="management-messages">2.4.2.2 Management Messages</h4>
<p>A number of management messages are defined to provide additional means to verify the validity of the blockchain address and related account, to support cryptographic functions and to test connectivity and functionality.</p>
<table>
<colgroup>
<col width="6%" />
<col width="22%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>A</code></td>
<td align="left"><code>Authentication</code></td>
<td align="left">Message introducing the sender on the network with the sender's authentication data</td>
</tr>
<tr class="even">
<td align="left"><code>K</code></td>
<td align="left"><code>Crypto</code></td>
<td align="left">Message for management of keys and parameters of cryptographic functions</td>
</tr>
<tr class="odd">
<td align="left"><code>T</code></td>
<td align="left"><code>Test</code></td>
<td align="left">Message that can be used for testing Whiteflag functionality by applications</td>
</tr>
</tbody>
</table>
<h4 id="duress-indicator">2.4.2.3 Duress Indicator</h4>
<p>The Whiteflag Protocol provides duress functionality, i.e. an indicator that a message has been sent under (threat of) violence, or other pressure and should therefore be interpreted with caution.</p>
<p>This functionality is especially useful for implementations of the protocol in devices used by workers and operators in the field, where there is a higher risk of hijacking and kidnapping resulting in possible misuse of the Whiteflag communication from an address of that account.</p>
<p>This standard only specifies how the duress indication is to be implemented in the protocol and how it should be interpreted. The way the Duress Indicator will be triggered by a Whiteflag capable application or device, is outside the scope of this standard, because this can be implemented in many different ways to suit different scenarios and requirements.</p>
<h3 id="spatial-information">2.4.3 Spatial information</h3>
<p>Signs and signals about structures and areas may contain spatial information. The Whiteflag protocol uses the EPSG:4326/WGS84 geodetic coordinate system. The protocol does (currently) not allow to provide height and altitude information, and therefore can only be used to provide an object location on the earth's surface.</p>
<p>Structures and areas can be represented using a limited number of geometric shapes: circles, rectangles and isosceles triangles, and any combination of these.</p>
<p>The real-world structure or area must be fully contained by the geometric shapes representing it. The centre of a geometric shape is determined by the location specified in the Whiteflag message. The orientation of the shape is the angle between a virtual north oriented vector, and the first specified dimension of the shape: this is one of the sides for a rectangle, and the height for an isosceles triangle; a circle does not have an orientation.</p>
<h2 id="minimum-implementation">2.5 Minimum Implementation</h2>
<p>When implementing this standard, it is not required to implement it in its entirety. However, any implementation of the Whiteflag Protocol that <em>sends</em> messages on the network, must implement at a minimum the following functionality:</p>
<ul>
<li>the <code>A</code> message with at least one authentication option;</li>
<li>the possibility to Recall, Update and Discontinue (Reference Codes <code>1</code>, <code>2</code> and <code>4</code>) any implemented sign or signal, if such Reference Type is valid i.a.w. Reference options.</li>
</ul>
<p>Also, for both senders and receivers, it is required that any part of this standard that is implemented complies with this standard.</p>
<h2 id="implementation-considerations">2.6 Implementation Considerations</h2>
<p>This paragraph addresses a number of aspects that are technically not part of the standard, but require consideration or are good practices for an interoperable and secure implementation of the Whiteflag protocol.</p>
<h3 id="trustworthiness-of-information">2.6.1 Trustworthiness of information</h3>
<p>The Whiteflag Protocol provides a trusted communication channel in the sense that the originator is authenticated, that messages cannot not be altered or disappear once recorded, all without the requirement of a trusted third party.</p>
<p>However, it is important to understand that a trusted communication channel does not by itself guarantee that the information in a message is true. Upon reception of a Whiteflag message, it is up to the receiver to assess the credibility of the information sent.</p>
<p>Nevertheless, the characteristics of the protocol do help in evaluating the credibility of information:</p>
<ul>
<li><p>The protocol ensures instant verification of the originator. Therefore, if a source is a priori considered reliable by the recipient (which will be often the case for NGOs, journalists, UN peacekeepers, UNMAS, civil authorities, etc.), the information can be considered to have a high level of credibility.</p></li>
<li><p>The protocol allows information to be confirmed by another message of a different originator, and therefore facilitates confirmation of the same information by multiple sources.</p></li>
<li><p>The protocol provides duress functionality;</p></li>
<li><p>Since all information is persistent, this allows for evaluating the reliability of a source over time by cross-checking facts in retrospect.</p></li>
</ul>
<p>A recipient may use the following levels of reliability of a source and credibility of information:</p>
<table>
<thead>
<tr class="header">
<th align="left">Reliability of Source</th>
<th align="left">Credibility of Information</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A. Completely reliable</td>
<td align="left">1. Confirmed by other sources</td>
</tr>
<tr class="even">
<td align="left">B. Usually reliable</td>
<td align="left">2. Probably true</td>
</tr>
<tr class="odd">
<td align="left">C. Fairly reliable</td>
<td align="left">3. Possibly true</td>
</tr>
<tr class="even">
<td align="left">D. Not usually reliable</td>
<td align="left">4. Doubtful</td>
</tr>
<tr class="odd">
<td align="left">E. Unreliable</td>
<td align="left">5. Improbable</td>
</tr>
<tr class="even">
<td align="left">F. Reliability cannot be judged</td>
<td align="left">6. Truth cannot be judged</td>
</tr>
</tbody>
</table>
<p>Also note that the protocol does not require all messages to be processed by a recipient. A recipient may choose to ignore unknown addresses and accounts, to blacklist unreliable addresses and accounts, to filter messages about an object outside a certain area of interest, create custom perspectives, merge information with other sources, etc. etc.</p>
<h3 id="account-and-private-key-protection">2.6.2 Account and Private Key Protection</h3>
<p>The protocol does not define any specific setup of the blockchain account and private key protection. There are however several important guidelines to consider.</p>
<ol style="list-style-type: decimal">
<li>Third party hosts should not be used to create accounts on a blockchain, because the identity of the sender should be directly linked to the account. Using a third party to create an account creates attack vectors by which an account could be compromised.</li>
<li>Public blockchains provide free, open source clients that facilitate the creation of accounts without any third party involved. Also, it is very possible to create specific Whiteflag software that also manages the associated blockchain accounts and cryptographic keys itself. In general, it is good practice to protect your account by implementing security measures on machines and devices under your own control or supervision.</li>
<li>Third party hosts should not be used to store private keys. Storing the secret key outside your control or under supervision creates attack vectors by which an account could be compromised.</li>
<li>To protect private keys from theft, hardware wallets, secure processing units and cold wallets should be used when possible.</li>
<li>To protect an account from being compromised, multi-factor authentication as well as multi-signature accounts may be used.</li>
<li>If account and/or related addresses need to be permanently de-activated, simply delete the private key(s), and, if possible, send an <code>A(4)</code> message for every <code>A(0)</code> sent before.</li>
</ol>
<h3 id="encryption-and-key-exchange">2.6.3 Encryption and Key Exchange</h3>
<p>The protocol provides the option to encrypt a message for confidentiality. When using encryption, a number of considerations should be taken into account:</p>
<ol style="list-style-type: decimal">
<li><p>Even if messages are encrypted, information may leak through usage patterns. Therefore, it is advised not to use the same blockchain addressed and the same proof-of-identity for both encrypted and unencrypted messages.</p></li>
<li><p>The security of encryption relies largely on the actual implementations.</p></li>
<li><p>All messages are persistent on the blockchain and it should be assumed that at some point in the future messages can and will be decrypted. Therefore, only use dedicated keys, and only encrypt information that is time-sensitive, i.e. information that will not be valid or relevant anymore over time, such as the status or the location of a moving object.</p></li>
</ol>
<h3 id="processing-and-storage-of-messages">2.6.4 Processing and Storage of Messages</h3>
<p>On the Whiteflag Network, messages must be formatted and processed as indicated in this standard. Additionally, this standard defines how messages and message sequences should be semantically interpreted.</p>
<p>To help implementing and validating Whiteflag Messages, Annex B provides a JSON schema that describes the messages, which might be of beneficial use for application developers.</p>
<p>However, strictly speaking, this schema is outside the scope of this standard: firstly because the Whiteflag Messages sent on the network are not JSON-formatted, and secondly because this standard does deliberately not specify how messages are to be processed and stored by applications (an application might very well use XML instead of JSON). Nevertheless, it is recommended to use a JSON format compliant with this schema for open APIs.</p>
<h2 id="note-on-the-notation-of-messages-and-message-sequences">2.7 Note on the notation of Messages and Message Sequences</h2>
<p>For documentation and software development purposes, messages codes and message sequences might be written as follows:</p>
<ul>
<li>a message may be referred to by its message code, e.g. <code>T</code> for a test message;</li>
<li>a specific sign or signal may be indicated by the combination of message and subject code, e.g. <code>E01</code> for a distress signal;</li>
<li>a reference indicator may be written in between brackets after the message code, e.g. <code>A(2)</code> for an update to an earlier <code>A</code> message;</li>
<li>an encrypted message is written between square brackets, e.g. <code>[Q(0)14]</code>;</li>
<li>the originator may be indicated behind the message code and reference indicator, e.g. <code>A(0)X</code> is an original authentication message from X;</li>
<li>the symbol <code>&lt;</code> is used as a pointer in the message sequence; the symbol is repeated to indicate to which message is referred, e.g. <code>&lt;&lt;</code> means two messages before.</li>
</ul>
<p>For example, a message from originator X for relating an area under attack to an existing protective sign from a hospital H may be written as <code>P31(0)H &lt; D10(5)X</code>. When the attack ends and the status of the hospital is provided, the full sequence will read: <code>P31(0)H &lt; D10(5)X &lt; D10(4)X &lt;&lt;&lt; S23(5)H</code>.</p>
<h1 id="use-case-examples">3 Use Case Examples</h1>
<p>(<em>moved to Annex F</em>)</p>
<h1 id="message-format">4 Message Format</h1>
<h2 id="message-structure">4.1 Message Structure</h2>
<h3 id="representations">4.1.1 Representations</h3>
<p>A Whiteflag message can have different representations at different levels of the protocol stack:</p>
<ul>
<li>at the Blockchain Overlay Network Layer (i.e. the level at which the Whiteflag Network is established) the message is represented as a compressed binary string, and optionally encrypted;</li>
<li>at the Decentralised Protocol Layer, a message is represented as an uncompressed and unencrypted concatenated character string comprised of the message fields;</li>
<li>at the API layer, a message and its message fields can have any appropriate representation using a structured language, such as JSON or XML;</li>
</ul>
<p>The standard describes the uncompressed and unencrypted concatenated character string at the Decentralised Protocol Layer, and how these messages are compressed into a binary string, and optionally encrypted.</p>
<h3 id="encoding">4.1.2 Encoding</h3>
<p>An uncompressed and unencrypted Whiteflag Message consists of:</p>
<ul>
<li>the Message Header (described in 4.2 Message Header), which is the same for all messages and consists of 7 fields with a total length of 71 bytes;</li>
<li>the Message Body (described in 4.3 Message Body), of which the fields and number of bytes per field differ between message types, and is therefore variable in length.</li>
</ul>
<p>The individual bytes of an uncompressed and unencrypted messages are encoded using a single 7-bit/1-byte UTF-8 code unit, allowing the usage of UTF-8/Unicode code points <code>U+0000</code> through <code>U+007F</code>, which are identical to the first 128 characters of the ASCII-set.</p>
<p>Depending on the usage of the field, not all characters/code points are allowed for each field. The field descriptions of the message header and body in 4.2 Message Header and in 4.3. Message Body, use the following characters to indicate which subset of characters is valid:</p>
<ul>
<li><p><code>c</code> indicates any valid 1 byte UTF-8/Unicode character, i.e. UTF-8 code points <code>U+0000</code> through <code>U+007F</code>;</p></li>
<li><p><code>a</code> indicates that any alpha-numeric character (0-9, A-Z, a-z), i.e. UTF-8 code points <code>U+0030</code> through <code>U+0039</code>, <code>U+0041</code> through <code>U+005A</code>, and <code>U+0061</code> through <code>U+007A</code>;</p></li>
<li><p><code>b</code> indicates that only a binary character (0-1) is the be used, i.e. UTF-8 code points <code>U+0030</code> trough <code>U+0031</code>;</p></li>
<li><p><code>d</code> indicates that only a decimal character (0-9) is to be used, i.e. UTF-8 code points <code>U+0030</code> trough <code>U+0039</code>;</p></li>
<li><p><code>x</code> indicates that only a hexadecimal character (0-F) is to be used, i.e. UTF-8 code points <code>U+0030</code> trough <code>U+0039</code>, and <code>U+0041</code> trough <code>U+0046</code>.</p></li>
</ul>
<p>Instead of <code>d</code>, the letters <code>y</code>, <code>m</code>, <code>d</code>, <code>h</code>, <code>m</code>, and <code>s</code> are used in some field descriptions in and Message Body to indicate digits representing years, minutes, days, degrees, hours, minutes and seconds respectively. Syntactically they are the same as a decimal character indicated with a <code>d</code>, and therefore encoded and compressed in the same way, but semantically they are different.</p>
<p>Capitals used in the field format descriptions of the message header and body in 4.2 Message Header and in 4.3 Message Body, including capitals of the above, indicate that such a character is to be used literally.</p>
<p>Before the message is embedded in a blockchain transaction, the message is compressed and optionally encrypted as described below.</p>
<h3 id="compression">4.1.3 Compression</h3>
<p>Whiteflag messages must be compressed to allow usage on blockchains with limited space for custom information, and to improve optional encryption. Compression of the message is done as follows:</p>
<ul>
<li><p>all fixed characters are omitted, except for the Prefix field;</p></li>
<li><p>binary characters (<code>b</code>), binary indicators and number signs are compressed to 1 bit;</p></li>
<li><p>decimal and hexadecimal characters (<code>d</code> and <code>h</code>) are compressed to a half-byte (4 bits) unsigned binary coded decimal/hexadecimal.</p></li>
</ul>
<p>The descriptions of the message header and body in 4.2 Message Header and in 4.3 Message Body, show how the compression must be applied to each field.</p>
<h3 id="encryption">4.1.4 Encryption</h3>
<p>The third field of the message is an indicator for which encryption is being used. This standard currently only provides limited support for encryption, but allows implementation specific encryption mechanisms.</p>
<p>If encryption is used, the whole message must be encrypted, except for the <code>Prefix</code>, <code>Version</code> and <code>EncryptionIndicator</code>, which must never be encrypted.</p>
<p>Note that, depending on the encryption algorithm used, the resulting length of the message may differ from the unencrypted message length, which may complicate the embedding of the message in a transaction on certain blockchains.</p>
<h3 id="embedding">4.1.5 Embedding</h3>
<p>To finally send the message, after compression and encryption, the message is embedded in a blockchain transaction. How the message is embedded in the transaction depends on the blockchain and is specified in Annex A.</p>
<h2 id="message-header">4.2 Message Header</h2>
<h3 id="generic-message-header">4.2.1 Generic Message Header</h3>
<p>All messages use the same generic message header, specified below.</p>
<h4 id="generic-message-header-fields">4.2.1.1 Generic Message Header Fields</h4>
<table style="width:100%;">
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="15%" />
<col width="34%" />
<col width="15%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Byte Index</th>
<th align="left">Byte Length</th>
<th align="left">Field</th>
<th align="left">Usage</th>
<th align="left">Uncompressed Encoding</th>
<th align="left">Compressed Encoding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0-1</td>
<td align="left">2</td>
<td align="left"><code>Prefix</code></td>
<td align="left">Identifies the message as a whiteflag message</td>
<td align="left"><code>WF</code></td>
<td align="left">2x 8-bit UTF-8</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">1</td>
<td align="left"><code>Version</code></td>
<td align="left">Indicates which version of the standard is used to generate the message</td>
<td align="left"><code>a</code></td>
<td align="left">1x 8-bit UTF-8</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">1</td>
<td align="left"><code>EncryptionIndicator</code></td>
<td align="left">Indicates if and which encryption is used</td>
<td align="left"><code>a</code></td>
<td align="left">1x 8-bit UTF-8</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">1</td>
<td align="left"><code>DuressIndicator</code></td>
<td align="left">Indicates whether the message was sent under force or threat</td>
<td align="left"><code>b</code></td>
<td align="left">1x 1-bit binary</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">1</td>
<td align="left"><code>MessageCode</code></td>
<td align="left">Indicates the type of message</td>
<td align="left"><code>a</code></td>
<td align="left">1x 8-bit UTF-8</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">1</td>
<td align="left"><code>ReferenceIndicator</code></td>
<td align="left">Indicates how this message relates to an earlier message</td>
<td align="left"><code>x</code></td>
<td align="left">1x 4-bit unsigned binary coded hexadecimal</td>
</tr>
<tr class="odd">
<td align="left">7-70</td>
<td align="left">64</td>
<td align="left"><code>ReferencedMessage</code></td>
<td align="left">Blockchain dependent reference to a related earlier message</td>
<td align="left"><code>xxxxxxxxxx ... xxxxxxxxxx</code></td>
<td align="left">64x 4-bit unsigned binary coded hexadecimal</td>
</tr>
</tbody>
</table>
<h4 id="prefix-field">4.2.1.2 Prefix Field</h4>
<p>The <code>Prefix</code> field is a fixed value field to easily identify Whiteflag Messages on the blockchain. The filed must contain two 1-byte UTF-8 encoded characters <code>WF</code>.</p>
<h4 id="version-field">4.2.1.3 Version Field</h4>
<p>The <code>Version</code> field indicates which version of the standard is used as the specification for the message. For implementations based on this version of the specification, the field must be a 1-byte UTF-8 encoded character <code>1</code>.</p>
<h4 id="encryption-indicator-field">4.2.1.4 Encryption Indicator Field</h4>
<p>The <code>EncryptionIndicator</code> field specifies how if and how a message is encrypted for confidentiality. The contents of the field must be a 1-byte UTF-8 encoded alpha-numeric character i.a.w. the following table.</p>
<table>
<colgroup>
<col width="7%" />
<col width="18%" />
<col width="74%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Encryption</th>
<th align="left">Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>0</code></td>
<td align="left">No encryption</td>
<td align="left">No encryption is used</td>
</tr>
<tr class="even">
<td align="left"><code>1</code></td>
<td align="left"><code>aes-256-ctr-ecdh</code></td>
<td align="left">Message is encrypted using 256-bit key AES counter mode with an ECDH negotiated key</td>
</tr>
<tr class="odd">
<td align="left"><code>2</code></td>
<td align="left"><code>aes-256-ctr-psk</code></td>
<td align="left">Message is encrypted using 256-bit key AES counter mode with a pre-shared key</td>
</tr>
<tr class="even">
<td align="left"><code>3</code>-<code>9</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used</td>
</tr>
<tr class="odd">
<td align="left">(other)</td>
<td align="left">(private use)</td>
<td align="left">Encrypted with a method indicated by the value, but specific to the application or originator</td>
</tr>
</tbody>
</table>
<h4 id="duress-indicator-field">4.2.1.5 Duress Indicator Field</h4>
<p>The <code>DuressIndicator</code> field value must be <code>0</code>, unless the sign or signal was sent under threat or force. In that case the DuressIndicator field must be <code>1</code>.</p>
<p>See Duress Indicator for further considerations on the duress functionality.</p>
<h4 id="message-code-field">4.2.1.6 Message Code Field</h4>
<p>The <code>MessageCode</code> field specifies the message type. The contents of the field must be a 1 byte UTF-8 encoded alpha-numeric character value corresponding with a message type defined in this specification.</p>
<p>A message with an invalid, i.e. undefined, message code, must be ignored.</p>
<h4 id="reference-indicator-field">4.2.1.7 Reference Indicator Field</h4>
<p>The <code>ReferenceIndicator</code> field specifies how a message relates to an earlier message. The contents of the field must be a 1-byte UTF-8 encoded value from the following table.</p>
<table>
<colgroup>
<col width="3%" />
<col width="11%" />
<col width="38%" />
<col width="47%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Value</th>
<th align="left">Reference Type</th>
<th align="left">Meaning</th>
<th align="left">Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>0</code></td>
<td align="left"><code>Original</code></td>
<td align="left">This message provides new information and is not related to an earlier message.</td>
<td align="left">May be used by any account. Must be used if no other reference type is used.</td>
</tr>
<tr class="even">
<td align="left"><code>1</code></td>
<td align="left"><code>Recall</code></td>
<td align="left">The originator recalls the referenced message; the referenced message must be ignored.</td>
<td align="left">May only be used by the same account of the referenced message. The information in this message must repeat the referenced message.</td>
</tr>
<tr class="odd">
<td align="left"><code>2</code></td>
<td align="left"><code>Update</code></td>
<td align="left">This message provides updated information and replaces the information in the referenced message.</td>
<td align="left">May only be used by the same account of the referenced message. The information that did not change must be the same as in the referenced message.</td>
</tr>
<tr class="even">
<td align="left"><code>3</code></td>
<td align="left"><code>Add</code></td>
<td align="left">This message adds additional information to the referenced message, i.e. ties two messages together.</td>
<td align="left">May only be used by the same account of the referenced message.</td>
</tr>
<tr class="odd">
<td align="left"><code>4</code></td>
<td align="left"><code>Discontinue</code></td>
<td align="left">The originator discontinues the referenced message, i.e. the information or action is no longer valid.</td>
<td align="left">May only be used by the same account of the referenced message. The information in this message must repeat the referenced message.</td>
</tr>
<tr class="even">
<td align="left"><code>5</code></td>
<td align="left"><code>Relate</code></td>
<td align="left">The information in this message directly relates to the information or action in the referenced message.</td>
<td align="left">May be used by any account, and may reference messages from any other account.</td>
</tr>
<tr class="odd">
<td align="left"><code>6</code></td>
<td align="left"><code>Confirm</code></td>
<td align="left">The originator confirms the information or action in the referenced message.</td>
<td align="left">May be used by any account of a different originator than of the referenced message. The information in this message must repeat the referenced message.</td>
</tr>
<tr class="even">
<td align="left"><code>7</code></td>
<td align="left"><code>Acknowledge</code></td>
<td align="left">The originator acknowledges the receipt of the referenced message, but the information itself is not confirmed.</td>
<td align="left">May be used by any account of a different originator than of the referenced message. The information in this message must repeat the referenced message.</td>
</tr>
<tr class="odd">
<td align="left"><code>8</code></td>
<td align="left"><code>Comply</code></td>
<td align="left">The originator will comply with and/or act according to the referenced message, but the information itself is not confirmed.</td>
<td align="left">May be used by any account of a different originator than of the referenced message. The information in this message must repeat the referenced message.</td>
</tr>
<tr class="even">
<td align="left"><code>9</code></td>
<td align="left"><code>Reject</code></td>
<td align="left">The originator does not agree (any more) with the information or action in the referenced message.</td>
<td align="left">May be used by any account of a different originator than of the referenced message. The information in this message must repeat the referenced message.</td>
</tr>
</tbody>
</table>
<p>A message with a Reference Indicator that does not comply with these rules must be ignored. However, a recipient may use non-compliant messages to evaluate the reliability of the originator.</p>
<p>By referencing other messages, message sequences can be created. However, not every message type and reference type may reference every other message type and reference type. The rules for referencing and functionality of message sequences are specified in detail in 5.4 Referencing.</p>
<h4 id="referenced-message-field">4.2.1.8 Referenced Message Field</h4>
<p>The <code>ReferencedMessage</code> field is a 64-byte UTF-8 encoded string containing a unique hexadecimal identifier of the referenced message. This allows for referencing a 256-bit hash. Since other messages can only be identified using the transaction identifier of the underlying blockchain, the identifier depends on the underlying blockchain. If the underlying blockchain uses a hash larger than 256 bits, the first 256 bits of the hash should be used. The transaction identifiers of the most common blockchains are shown in Annex A.</p>
<p>If the <code>ReferenceIndicator</code> field is <code>0</code>, the <code>ReferencedMessage</code> field must be ignored by the receiver. This allows the field to be filled with a random 64-byte UTF-8 encoded hexadecimal string, e.g. to prevent a large part of the message to be all zeros when encrypting it.</p>
<h2 id="message-body">4.3 Message Body</h2>
<h3 id="functional-messages-signs-signals">4.3.1 Functional Messages: Signs &amp; Signals</h3>
<h4 id="signs-signals-message-fields">4.3.1.1 Signs &amp; Signals Message Fields</h4>
<p>The message body of functional messages representing a sign (message types <code>P</code>, <code>D</code> and <code>I</code>) or a signal (message types <code>E</code>, <code>S</code>, <code>M</code> and <code>Q</code>), must contain the following fields:</p>
<table style="width:100%;">
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="14%" />
<col width="36%" />
<col width="15%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Byte Index</th>
<th align="left">Byte Length</th>
<th align="left">Field</th>
<th align="left">Usage</th>
<th align="left">Uncompressed Encoding</th>
<th align="left">Compressed Encoding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0- 70</td>
<td align="left">71</td>
<td align="left">Message Header</td>
<td align="left">See Generic Message Header Fields</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">71- 72</td>
<td align="left">2</td>
<td align="left"><code>SubjectCode</code></td>
<td align="left">Indicates the sign/signal type with the value defined in Subject Code Field</td>
<td align="left"><code>xx</code></td>
<td align="left">2x 4-bit unsigned binary coded hexadecimal</td>
</tr>
<tr class="odd">
<td align="left">73- 92</td>
<td align="left">15</td>
<td align="left"><code>DateTime</code></td>
<td align="left">Indicates when the sign/signal is valid, using an ISO 8601/ RFC 3339 timestamp</td>
<td align="left"><code>YYYY-MM-DDThh:mm:ssZ</code></td>
<td align="left">14x 4-bit unsigned binary coded decimal</td>
</tr>
<tr class="even">
<td align="left">93-102</td>
<td align="left">10</td>
<td align="left"><code>Duration</code></td>
<td align="left">Indicates how long the sign/signal will be valid, using the ISO 8601 format</td>
<td align="left"><code>PddDhhHmmM</code></td>
<td align="left">6x 4-bit unsigned binary coded decimal</td>
</tr>
<tr class="odd">
<td align="left">103-104</td>
<td align="left">2</td>
<td align="left"><code>ObjectType</code></td>
<td align="left">Specifies the type of object the sign/signal refers to</td>
<td align="left"><code>xx</code></td>
<td align="left">2x 4-bit unsigned binary coded hexadecimal</td>
</tr>
<tr class="even">
<td align="left">105-113</td>
<td align="left">9</td>
<td align="left"><code>ObjectLatitude</code></td>
<td align="left">Specifies the object location in decimal degrees latitude i.a.w. ISO 6709</td>
<td align="left"><code>\_dd.ddddd</code></td>
<td align="left">1x sign bit + 7x 4-bit unsigned binary coded decimal</td>
</tr>
<tr class="odd">
<td align="left">114-123</td>
<td align="left">10</td>
<td align="left"><code>ObjectLongitude</code></td>
<td align="left">Specifies the object location in decimal degrees longitude i.a.w. ISO 6709</td>
<td align="left"><code>\_ddd.ddddd</code></td>
<td align="left">1x sign bit + 8x 4-bit unsigned binary coded decimal</td>
</tr>
<tr class="even">
<td align="left">124-127</td>
<td align="left">4</td>
<td align="left"><code>ObjectSizeDim1</code></td>
<td align="left">Specifies the size of the object's first dimension in meters</td>
<td align="left"><code>nnnn</code></td>
<td align="left">4x 4-bit unsigned binary coded decimal</td>
</tr>
<tr class="odd">
<td align="left">128-131</td>
<td align="left">4</td>
<td align="left"><code>ObjectSizeDim2</code></td>
<td align="left">Specifies the size of the object's second dimension in meters</td>
<td align="left"><code>nnnn</code></td>
<td align="left">4x 4-bit unsigned binary coded decimal</td>
</tr>
<tr class="even">
<td align="left">132-134</td>
<td align="left">3</td>
<td align="left"><code>ObjectOrientation</code></td>
<td align="left">Specifies the object's orientation in degrees</td>
<td align="left"><code>nnn</code></td>
<td align="left">3x 4-bit unsigned binary coded decimal</td>
</tr>
</tbody>
</table>
<p>In addition, the message body of message type <code>Q</code> may be extended with the following fields:</p>
<table>
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="14%" />
<col width="36%" />
<col width="15%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Byte Index</th>
<th align="left">Byte Length</th>
<th align="left">Field</th>
<th align="left">Usage</th>
<th align="left">Uncompressed Encoding</th>
<th align="left">Compressed Encoding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">135-136</td>
<td align="left">2</td>
<td align="left"><code>ObjectType1</code></td>
<td align="left">Specifies the type of object for which the request is made</td>
<td align="left"><code>xx</code></td>
<td align="left">2x 4-bit unsigned binary coded hexadecimal</td>
</tr>
<tr class="even">
<td align="left">137-138</td>
<td align="left">2</td>
<td align="left"><code>ObjectType1Quant</code></td>
<td align="left">Specifies the number of objects for which the request is made</td>
<td align="left"><code>dd</code></td>
<td align="left">2x 4-bit unsigned binary coded decimal</td>
</tr>
</tbody>
</table>
<p>These fields may be repeated for additional objects for which the request is made, e.g. bytes 139-142 may contain additional <code>ObjectType2</code> and <code>ObjectType2Quant</code> fields, etc.</p>
<h4 id="subject-code-field">4.3.1.2 Subject Code Field</h4>
<p>The <code>SubjectCode</code> field defines the actual sign or signal, and must be 2-byte UTF-8 encoded value from the following tables with subject codes for each sign/signal message type below. Common official and/or visual equivalents for the defined signs and signals are shown in Annex E.</p>
<h5 id="protective-signs">4.3.1.2.1 Protective Signs</h5>
<table>
<thead>
<tr class="header">
<th align="left">Message Code</th>
<th align="left">Usage</th>
<th align="left">Subject Code</th>
<th align="left">Usage / Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>P</code></td>
<td align="left">Protective Sign</td>
<td align="left"><code>00</code></td>
<td align="left">Unspecified Protective Sign</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>01</code></td>
<td align="left">White flag - Unspecified intent</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>02</code></td>
<td align="left">White flag - Request for negotiation</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>03</code></td>
<td align="left">White flag - Surrender</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>04</code>-<code>0F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>10</code></td>
<td align="left">Unspecified Red Cross/Crescent/Crystal</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>11</code></td>
<td align="left">Red Cross</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>12</code></td>
<td align="left">Red Crescent</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>13</code></td>
<td align="left">Red Crystal</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>14</code>-<code>1F</code></td>
<td align="left">(reserved for use by the IFRC)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>20</code></td>
<td align="left">United Nations</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>21</code>-<code>2F</code></td>
<td align="left">(reserved for use by the UN)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>30</code></td>
<td align="left">Unspecified Protected Zone</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>31</code></td>
<td align="left">Hospital and Safety Zone</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>32</code></td>
<td align="left">Prisoner of War Camp</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>33</code></td>
<td align="left">Internment Camp</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>34</code>-<code>3F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>40</code></td>
<td align="left">Civil Defence</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>41</code>-<code>4F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>50</code></td>
<td align="left">Unspecified Cultural Property</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>51</code></td>
<td align="left">Monuments and Cultural Institutions</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>52</code></td>
<td align="left">Cultural Property</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>53</code></td>
<td align="left">Cultural Property under Special Protection</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>54-5F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>60</code></td>
<td align="left">Works and Installations containing Dangerous Forces</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>61</code>-<code>6F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>70</code>-<code>FF</code></td>
<td align="left">(reserved)</td>
</tr>
</tbody>
</table>
<p>References: <em>P01-03</em>: i.a.w. Convention (IV) respecting the Laws and Customs of War on Land and its annex: Regulations concerning the Laws and Customs of War on Land. The Hague, 18 October 1907 <em>P11-12</em>: Convention (I) for the Amelioration of the Condition of the Wounded and Sick in Armed Forces in the Field. Geneva, 12 August 1949. <em>P13</em>: Protocol additional to the Geneva Conventions of 12 August 1949, and relating to the Adoption of an Additional Distinctive Emblem (Protocol III), 8 December 2005. <em>P20</em>: Convention on the Safety of United Nations and Associated Personnel. New York, 9 December 1994. <em>P31</em>: Convention (IV) relative to the Protection of Civilian Persons in Time of War. Geneva, 12 August 1949 <em>P32-33</em>: Convention (III) relative to the Treatment of Prisoners of War. Geneva, 12 August 1949. <em>P51</em>: Treaty on the Protection of Artistic and Scientific Institutions and Historic Monuments (Roerich Pact). Washington, 15 April 1935 <em>P52-53</em>: The 1954 Hague Convention for the Protection of Cultural Property in the Event of Armed Conflict and its two (1954 and 1999) Protocols, United Nations Educational, Scientific and Cultural Organization (UNESCO) <em>P60</em>: Protocol Additional to the Geneva Conventions of 12 August 1949, and relating to the Protection of Victims of International Armed Conflicts (Protocol I), 8 June 1977.</p>
<h5 id="emergency-signals">4.3.1.2.2 Emergency Signals</h5>
<table>
<thead>
<tr class="header">
<th align="left">Message Code</th>
<th align="left">Usage</th>
<th align="left">Subject Code</th>
<th align="left">Usage / Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>E</code></td>
<td align="left">Emergency Signal</td>
<td align="left"><code>00</code></td>
<td align="left">Unspecified Emergency</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>01</code></td>
<td align="left">General Distress signal</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>02</code></td>
<td align="left">General Urgency signal</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>03</code>-<code>0F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>10</code></td>
<td align="left">Urgent Unspecified Assistance Required</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>11</code></td>
<td align="left">Urgent Medical Assistance Required</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>12</code></td>
<td align="left">Urgent Fire &amp; Rescue Assistance Required</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>13</code></td>
<td align="left">Urgent Law Enforcement Assistance Required</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>14</code></td>
<td align="left">Urgent Disaster Response Required</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>15</code>-<code>1F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>20</code>-<code>FF</code></td>
<td align="left">(reserved)</td>
</tr>
</tbody>
</table>
<h5 id="danger-disaster-signs">4.3.1.2.3 Danger &amp; Disaster Signs</h5>
<table>
<thead>
<tr class="header">
<th align="left">Message Code</th>
<th align="left">Usage</th>
<th align="left">Subject Code</th>
<th align="left">Usage / Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>D</code></td>
<td align="left">Danger Sign</td>
<td align="left"><code>00</code></td>
<td align="left">Unspecified Danger Area</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>10</code></td>
<td align="left">War/Conflict/Terrorism - Unspecified Attack</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>11</code></td>
<td align="left">War/Conflict/Terrorism - Direct Ground Attack</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>12</code></td>
<td align="left">War/Conflict/Terrorism - Mortar/Artillery Attack</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>13</code></td>
<td align="left">War/Conflict/Terrorism - Ground Bomb Attack</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>14</code></td>
<td align="left">War/Conflict/Terrorism - Air Attack</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>15</code></td>
<td align="left">War/Conflict/Terrorism - Complex Attack</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>16</code>-<code>19</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>1A</code></td>
<td align="left">War/Conflict/Terrorism - Chemical Attack</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>1B</code></td>
<td align="left">War/Conflict/Terrorism - Biological Attack</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>1C</code></td>
<td align="left">War/Conflict/Terrorism - Nuclear Attack</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>1D</code>-<code>1F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>20</code></td>
<td align="left">Unspecified Hazardous Conflict Area</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>21</code></td>
<td align="left">Hazardous Conflict Area - Mine Field</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>22</code></td>
<td align="left">Hazardous Conflict Area - UXOs</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>23</code></td>
<td align="left">Hazardous Conflict Area - Chemical Contamination</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>24</code></td>
<td align="left">Hazardous Conflict Area - Biological Contamination</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>25</code></td>
<td align="left">Hazardous Conflict Area - Radiological Contamination</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>26</code></td>
<td align="left">Hazardous Conflict Area - Nuclear Contamination</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>27</code></td>
<td align="left">Hazardous Conflict Area - Surface-to-Air Threat</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>28</code>-<code>2F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>30</code></td>
<td align="left">Unspecified Transport Accident</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>31</code></td>
<td align="left">Transport Accident - Air</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>32</code></td>
<td align="left">Transport Accident - Rail</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>33</code></td>
<td align="left">Transport Accident - Road</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>34</code></td>
<td align="left">Transport Accident - Boat</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>35</code>-<code>3F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>40</code></td>
<td align="left">Unspecified Industrial Accident</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>41</code></td>
<td align="left">Industrial Accident - Accident release (other than attack)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>42</code></td>
<td align="left">Industrial Accident - Explosion (other than attack)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>43</code></td>
<td align="left">Industrial Accident - Chemical explosion (other than attack)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>44</code></td>
<td align="left">Industrial Accident - Nuclear explosion/Radiation (other than attack)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>45</code></td>
<td align="left">Industrial Accident - Mine explosion</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>46</code></td>
<td align="left">Industrial Accident - Pollution</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>47</code></td>
<td align="left">Industrial Accident - Acid rain</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>48</code></td>
<td align="left">Industrial Accident - Atmosphere pollution</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>49</code>-<code>4F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>50</code></td>
<td align="left">Complex/Man-made Hazard - Complex Emergency</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>51</code></td>
<td align="left">Complex/Man-made Hazard - Uncontrolled Banditry</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>52</code></td>
<td align="left">Complex/Man-made Hazard - Uncontrolled Uprising</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>53</code></td>
<td align="left">Complex/Man-made Hazard - Displaced Population</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>54</code></td>
<td align="left">Complex/Man-made Hazard - Famine and Food Insecurity</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>55</code>-<code>5F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>60</code>-<code>9F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>A0</code></td>
<td align="left">Unspecified Geophysical Disaster Area</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>A1</code></td>
<td align="left">Geophysical Disaster Area - Earthquake</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>A2</code></td>
<td align="left">Geophysical Disaster Area - Earthquake w/ Tsunami</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>A3</code></td>
<td align="left">Geophysical Disaster Area - Volcano</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>A4</code></td>
<td align="left">Geophysical Disaster Area - Dry Mass Movement - Rockfall</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>A5</code></td>
<td align="left">Geophysical Disaster Area - Dry Mass Movement - Landslide</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>A6</code></td>
<td align="left">Geophysical Disaster Area - Dry Mass Movement - Avalanche</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>A7</code></td>
<td align="left">Geophysical Disaster Area - Dry Mass Movement - Subsidence</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>A8</code>-<code>AF</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>B0</code></td>
<td align="left">Unspecified Meteorological Disaster Area</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>B1</code></td>
<td align="left">Meteorological Disaster Area - Unspecified Storm</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>B2</code></td>
<td align="left">Meteorological Disaster Area - Storm - Tropical Cyclone</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>B3</code></td>
<td align="left">Meteorological Disaster Area - Storm - Extra Tropical Cyclone</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>B4</code></td>
<td align="left">Meteorological Disaster Area - Local Storm</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>B5</code>-<code>BF</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>C0</code></td>
<td align="left">Unspecified Hydrological Disaster Area</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>C1</code></td>
<td align="left">Hydrological Disaster Area - General Flood</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>C2</code></td>
<td align="left">Hydrological Disaster Area - Flash Flood</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>C3</code></td>
<td align="left">Hydrological Disaster Area - Storm Surge</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>C4</code></td>
<td align="left">Hydrological Disaster Area - Wet Mass Movement - Rockfall</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>C5</code></td>
<td align="left">Hydrological Disaster Area - Wet Mass Movement - Landslide</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>C6</code></td>
<td align="left">Hydrological Disaster Area - Wet Mass Movement - Avalanche</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>C7</code></td>
<td align="left">Hydrological Disaster Area - Wet Mass Movement - Subsidence</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>C8</code>-<code>CF</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>D0</code></td>
<td align="left">Unspecified Climatological Disaster Area</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>D1</code></td>
<td align="left">Climatological Disaster Area - Extreme Temp - Heat Wave</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>D2</code></td>
<td align="left">Climatological Disaster Area - Extreme Temp - Cold Wave</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>D3</code></td>
<td align="left">Climatological Disaster Area - Extreme Winter Condition</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>D4</code></td>
<td align="left">Climatological Disaster Area - Drought</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>D5</code></td>
<td align="left">Climatological Disaster Area - Wildfire - Forest Fire</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>D6</code></td>
<td align="left">Climatological Disaster Area - Wildfire - Land Fire</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>D7</code>-<code>DF</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>E0</code></td>
<td align="left">Unspecified Biological Disaster Area</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>E1</code></td>
<td align="left">Biological Disaster Area - Unspecified Epidemic</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>E2</code></td>
<td align="left">Biological Disaster Area - Viral Infectious Disease Epidemic</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>E3</code></td>
<td align="left">Biological Disaster Area - Bacterial Infectious Disease Epidemic</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>E4</code></td>
<td align="left">Biological Disaster Area - Parasitic Infectious Disease Epidemic</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>E5</code></td>
<td align="left">Biological Disaster Area - Fungal Infectious Disease Epidemic</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>E6</code></td>
<td align="left">Biological Disaster Area - Prion Infectious Disease Epidemic</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>E7</code></td>
<td align="left">Biological Disaster Area - Insect Infestation</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>E8</code></td>
<td align="left">Biological Disaster Area - Animal Stampede</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>E9</code>-<code>EF</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>F0</code>-<code>FF</code></td>
<td align="left">(private use, i.e. not standardized)</td>
</tr>
</tbody>
</table>
<h5 id="status-signals">4.3.1.2.4 Status Signals</h5>
<table>
<thead>
<tr class="header">
<th align="left">Message Code</th>
<th align="left">Usage</th>
<th align="left">Subject Code</th>
<th align="left">Usage / Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>S</code></td>
<td align="left">Status Signal</td>
<td align="left"><code>00</code></td>
<td align="left">Unspecified positive status</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>01</code>-<code>0F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>10</code></td>
<td align="left">Proof of Life without further details</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>11</code></td>
<td align="left">Proof of Life and Situation Normal</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>12</code></td>
<td align="left">Proof of Life and Contact Requested</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>13</code></td>
<td align="left">Proof of Life but Assistance Required</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>14</code>-<code>1F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>20</code></td>
<td align="left">Object status unknown</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>21</code></td>
<td align="left">Object functional without further details</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>22</code></td>
<td align="left">Object functional and in good order</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>23</code></td>
<td align="left">Object functional but damaged</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>24</code></td>
<td align="left">Object not functional without further details</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>25</code></td>
<td align="left">Object not functional and damaged</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>26</code></td>
<td align="left">Object damaged without further details</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>28</code></td>
<td align="left">Object destroyed</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>29</code>-<code>2F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>30</code>-<code>EF</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>F0</code>-<code>FF</code></td>
<td align="left">(private use, i.e. not standardized)</td>
</tr>
</tbody>
</table>
<h3 id="infrastructure-signs">4.3.1.2.5 Infrastructure Signs</h3>
<table>
<thead>
<tr class="header">
<th align="left">Message Code</th>
<th align="left">Usage</th>
<th align="left">Subject Code</th>
<th align="left">Usage / Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>I</code></td>
<td align="left">Infrastructure</td>
<td align="left"><code>00</code></td>
<td align="left">Unspecified infrastructure</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>01</code>-<code>0F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>10</code></td>
<td align="left">Transportation - Unspecified transportation infrastructure</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>11</code></td>
<td align="left">Transportation - Road or Highway</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>12</code></td>
<td align="left">Transportation - Mass Transit System</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>13</code></td>
<td align="left">Transportation - Railway</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>14</code></td>
<td align="left">Transportation - Canal or Navigable Waterway</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>15</code></td>
<td align="left">Transportation - Seaport</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>16</code></td>
<td align="left">Transportation - Lighthouse</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>17</code></td>
<td align="left">Transportation - Airport</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>18</code>-<code>1F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>20</code></td>
<td align="left">Energy - Unspecified energy infrastructure</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>21</code></td>
<td align="left">Energy - Electrical transmission/distribution</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>22</code></td>
<td align="left">Energy - Natural gas pipeline</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>23</code></td>
<td align="left">Energy - Petroleum pipeline</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>24</code></td>
<td align="left">Energy - Oil-fired power plant</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>25</code></td>
<td align="left">Energy - Gas-fired power plant</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>26</code></td>
<td align="left">Energy - Coal-fired power plant</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>27</code></td>
<td align="left">Energy - Nuclear power plant</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>28</code></td>
<td align="left">Energy - Hydro-electric power plant</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>29</code></td>
<td align="left">Energy - Geothermal energy installation</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>2A</code></td>
<td align="left">Energy - Solar energy installation</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>2B</code></td>
<td align="left">Energy - Wind energy installation</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>2C</code></td>
<td align="left">Energy - Ocean power installation</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>2D</code></td>
<td align="left">Energy - Biomass installation</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>2E</code>-<code>2F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>30</code></td>
<td align="left">Water management - Unspecified water facility</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>31</code></td>
<td align="left">Water management - Drinking water distribution pipeline</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>32</code></td>
<td align="left">Water management - Drinking water storage reservoir</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>33</code></td>
<td align="left">Water management - Drinking water treatment facility</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>34</code></td>
<td align="left">Water management - Waste water collection/disposal facility</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>35</code></td>
<td align="left">Water management - Drainage system</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>36</code></td>
<td align="left">Water management - Major irrigation system</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>37</code></td>
<td align="left">Water management - Major flood control system</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>38</code></td>
<td align="left">Water management - Coastal water management facility</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>39</code>-<code>3F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>40</code></td>
<td align="left">Communication - Unspecified communication infrastructure</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>41</code></td>
<td align="left">Communication - Postal service</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>42</code></td>
<td align="left">Communication - Telephone land line</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>43</code></td>
<td align="left">Communication - Telephone exchange system</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>44</code></td>
<td align="left">Communication - Mobile phone network system</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>45</code></td>
<td align="left">Communication - Television transmission station</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>46</code></td>
<td align="left">Communication - Radio transmission station</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>47</code></td>
<td align="left">Communication - Internet backbone</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>48</code></td>
<td align="left">Communication - Internet core router</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>49</code></td>
<td align="left">Communication - Undersea cable</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>4A</code>-<code>4F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>50</code></td>
<td align="left">Public service - Unspecified public service</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>51</code></td>
<td align="left">Public service - Hospital</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>52</code></td>
<td align="left">Public service - School</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>53</code></td>
<td align="left">Public service - Police station</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>54</code></td>
<td align="left">Public service - Fire station</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>55-5F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>60</code></td>
<td align="left">Solid waste management - Unspecified solid waste management facility</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>61</code></td>
<td align="left">Solid waste management - Municipal garbage and recyclables collection</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>62</code></td>
<td align="left">Solid waste management - Solid waste landfill</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>63</code></td>
<td align="left">Solid waste management - Solid waste incinerator</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>64</code></td>
<td align="left">Solid waste management - Materials recovery facility</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>65</code></td>
<td align="left">Solid waste management - Hazardous waste disposal facility</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>66</code>-<code>6F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>70</code>-<code>EF</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>F0</code>-<code>FF</code></td>
<td align="left">(private use, i.e. not standardized)</td>
</tr>
</tbody>
</table>
<h3 id="mission-signals">4.3.1.2.6 Mission Signals</h3>
<table>
<colgroup>
<col width="13%" />
<col width="17%" />
<col width="13%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Message Code</th>
<th align="left">Usage</th>
<th align="left">Subject Code</th>
<th align="left">Usage / Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>M</code></td>
<td align="left">Mission</td>
<td align="left"><code>00</code></td>
<td align="left">Unspecified Mission</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>01</code>-<code>0F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>10</code></td>
<td align="left">Unspecified Humanitarian Mission</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>11</code>-<code>1F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>20</code></td>
<td align="left">Unspecified Mission under Humanitarian Law</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>21</code></td>
<td align="left">Humanitarian Law - Monitoring</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>22</code></td>
<td align="left">Humanitarian Law - Visiting Prisoners of War and Detained Persons</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>23</code></td>
<td align="left">Humanitarian Law - Aid for Military Personnel - Health Care for wounded, sick or shipwrecked personnel</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>24</code></td>
<td align="left">Humanitarian Law - Aid for Civilian Population - General Aid</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>25</code></td>
<td align="left">Humanitarian Law - Aid for Civilian Population - Food Distribution</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>26</code></td>
<td align="left">Humanitarian Law - Aid for Civilian Population - Health Care</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>27</code></td>
<td align="left">Humanitarian Law - Aid for Civilian Population - Shelter</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>28</code></td>
<td align="left">Humanitarian Law - Aid for Civilian Population - Restoring Family Links</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>29</code></td>
<td align="left">Humanitarian Law - Aid for Civilian Population - Infrastructure Restoration</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>2A</code></td>
<td align="left">Humanitarian Law - Support to Local Government - Advisory</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>2B</code></td>
<td align="left">Humanitarian Law - Support Mission - Administrative</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>2C</code></td>
<td align="left">Humanitarian Law - Support Mission - Logistics</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>2D</code>-<code>2F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>30</code></td>
<td align="left">Unspecified Disaster / Emergency Response Operation</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>31</code>-<code>3F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>40</code></td>
<td align="left">Unspecified Special Political Mission</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>41</code></td>
<td align="left">Special Political Mission - Envoy</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>42</code></td>
<td align="left">Special Political Mission - Sanction panel</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>43</code></td>
<td align="left">Special Political Mission - Monitoring group</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>44</code></td>
<td align="left">Special Political Mission - Field-based mission</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>41</code>-<code>4F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>50</code></td>
<td align="left">Unspecified Diplomatic Mission</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>51</code>-<code>5F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>60</code></td>
<td align="left">Unspecified Law Enforcement Operation</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>61</code>-<code>6F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>70</code></td>
<td align="left">Unspecified Peace Operation</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>71</code></td>
<td align="left">Peace Operation - Conflict prevention</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>72</code></td>
<td align="left">Peace Operation - Peacemaking</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>73</code></td>
<td align="left">Peace Operation - Peacekeeping</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>74</code></td>
<td align="left">Peace Operation - Peacebuilding</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>75</code></td>
<td align="left">Peace Operation - Peace enforcement</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>76</code>-<code>7F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>80</code></td>
<td align="left">Unspecified Military Operation</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>81</code>-<code>8F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>90</code>-<code>EF</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>F0</code>-<code>FF</code></td>
<td align="left">(private use, i.e. not standardized)</td>
</tr>
</tbody>
</table>
<h3 id="request-signals">4.3.1.2.7 Request Signals</h3>
<table>
<thead>
<tr class="header">
<th align="left">Message Code</th>
<th align="left">Usage</th>
<th align="left">Subject Code</th>
<th align="left">Usage / Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>Q</code></td>
<td align="left">Requests</td>
<td align="left"><code>00</code>-<code>0F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>10</code></td>
<td align="left">Request for Cease Fire</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>11</code>-<code>1F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>20</code></td>
<td align="left">Request for Area Access</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>21</code>-<code>2F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>30</code>-<code>EF</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>F0</code>-<code>FF</code></td>
<td align="left">(private use, i.e. not standardized)</td>
</tr>
</tbody>
</table>
<h4 id="datetime-field">4.3.1.3 DateTime Field</h4>
<p>The <code>DateTime</code> field must contain the moment in time using from when the sign or signal is valid, using Coordinated Universal Time (UTC).</p>
<p>This timestamp need not to be identical to the timestamp of the blockchain transaction of the message: the sign or signal may be valid from an earlier or future point in time and may therefore be earlier or later than the timestamp of the blockchain transaction.</p>
<p>Based on ISO 8601 and RFC 3339, the DateTime field must be formatted as follows: <code>YYYY-MM-DDThh:mm:ssZ</code>, where:</p>
<ul>
<li><p><code>yyyy</code> are 4 digits for the calendar year</p></li>
<li><p><code>mm</code> are 2 digits for the number of the month; valid values are: <code>01</code>-<code>12</code></p></li>
<li><p><code>dd</code> are 2 digits for the day of the month using; valid values are: <code>01</code>-<code>31</code></p></li>
<li><p><code>hh</code> are 2 digits for the hour of day; valid values are: <code>00</code>-<code>23</code></p></li>
<li><p><code>mm</code> are 2 digits for the minutes; valid values are: <code>00</code>-<code>59</code></p></li>
<li><p><code>ss</code> are 2 digits for the seconds; valid values are: <code>00</code>-<code>60</code> (including a possible leap second)</p></li>
<li><p><code>Z</code> is literally the character &quot;Z&quot;, indicating UTC.</p></li>
</ul>
<p>A message with an invalid DateTime field must be ignored.</p>
<h4 id="duration-field">4.3.1.4 Duration Field</h4>
<p>The <code>Duration</code> field may contain the time-period for how long the sign or signal is valid counted from the date and time in the <code>DateTime</code> field. A sign or signal may be valid for a definite period with a maximum of 99 days 23 hours and 59 minutes, or a minimum of 01 minute, or for an indefinite period.</p>
<p>Based on ISO 8601, the Duration field must be formatted as follows: <code>PnnDnnHnnM</code> (i.e. regular expression <code>\^P\[0-9\]{2}D\[0-9\]{2}H\[0-9\]{2}M\$</code>), where:</p>
<ul>
<li><p><code>P</code> is literally the character &quot;P&quot;, indicating that the string represents a period</p></li>
<li><p><code>nn</code> are 2 digits for the number of days; valid values are: <code>00</code>-<code>99</code></p></li>
<li><p><code>D</code> is literally the character &quot;D&quot;, indicating the previous digits represent the number of days</p></li>
<li><p><code>nn</code> are 2 digits for the number of hours; valid values are: <code>00</code>-<code>23</code></p></li>
<li><p><code>H</code> is literally the character &quot;H&quot;, indicating the previous digits represents the number of hours</p></li>
<li><p><code>nn</code> are 2 digits for the number of days; valid values are: <code>00</code>-<code>59</code></p></li>
<li><p><code>M</code> is literally the character &quot;M&quot;, indicating the previous digits represents the number of minutes</p></li>
</ul>
<p>For a sign/signal to be valid for an indefinite period, the duration must be set to 0 as follows: <code>P00D00H00M</code>.</p>
<p>A message with an invalid Duration field must be ignored.</p>
<h4 id="object-type-field">4.3.1.5 Object Type Field</h4>
<p>The <code>ObjectType</code> field contains a hexadecimal code to indicate to what sort of object the sign or signal applies to. This information is optional and must be set to 00 if not used. However, it is encouraged to use it, because it might be valuable for the receiver(s) of the message.</p>
<table>
<colgroup>
<col width="10%" />
<col width="29%" />
<col width="61%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Object Type</th>
<th align="left">Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>00</code></td>
<td align="left">Not provided</td>
<td align="left">Object type is unknown</td>
</tr>
<tr class="even">
<td align="left"><code>01</code>-<code>0F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"><code>10</code></td>
<td align="left">Unspecified group of people</td>
<td align="left">Unspecified number of humans together</td>
</tr>
<tr class="even">
<td align="left"><code>11</code></td>
<td align="left">Person</td>
<td align="left">An individual human</td>
</tr>
<tr class="odd">
<td align="left"><code>12</code></td>
<td align="left">Small group of people</td>
<td align="left">2- 10 humans together</td>
</tr>
<tr class="even">
<td align="left"><code>13</code></td>
<td align="left">Medium group of people</td>
<td align="left">10- 100 humans together</td>
</tr>
<tr class="odd">
<td align="left"><code>14</code></td>
<td align="left">Large group of people</td>
<td align="left">100- 1000 humans together</td>
</tr>
<tr class="even">
<td align="left"><code>15</code></td>
<td align="left">Enormous group of people</td>
<td align="left">1000-10000 humans together</td>
</tr>
<tr class="odd">
<td align="left"><code>12</code>-<code>1F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"><code>20</code></td>
<td align="left">Unspecified Area</td>
<td align="left">An area is a part of the earths surface, either on land or at sea.</td>
</tr>
<tr class="odd">
<td align="left"><code>21</code></td>
<td align="left">Circular Area</td>
</tr>
<tr class="even">
<td align="left"><code>22</code></td>
<td align="left">Rectangle Area</td>
</tr>
<tr class="odd">
<td align="left"><code>23</code></td>
<td align="left">Triangle Area</td>
</tr>
<tr class="even">
<td align="left"><code>24</code>-<code>2F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"><code>30</code></td>
<td align="left">Unspecified Structure</td>
<td align="left">Immovable human made individual structures that are fixed to the ground, such as buildings, installations, historic ruins, etc. For non-fixed human made structures or a clustering of structures, such as camps, an area object must be used.</td>
</tr>
<tr class="even">
<td align="left"><code>31</code></td>
<td align="left">Circular Structure</td>
</tr>
<tr class="odd">
<td align="left"><code>32</code></td>
<td align="left">Rectangle Structure</td>
</tr>
<tr class="even">
<td align="left"><code>33</code></td>
<td align="left">Triangle Structure</td>
</tr>
<tr class="odd">
<td align="left"><code>34</code>-<code>3F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"><code>40</code></td>
<td align="left">Unspecified Land Vehicle</td>
<td align="left">An object used for transport over land</td>
</tr>
<tr class="odd">
<td align="left"><code>41</code>-<code>4F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"><code>50</code></td>
<td align="left">Unspecified Water Vehicle</td>
<td align="left">An object used for transport on water</td>
</tr>
<tr class="odd">
<td align="left"><code>51</code>-<code>5F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"><code>60</code></td>
<td align="left">Unspecified Air Vehicle</td>
<td align="left">An object for transport in the air</td>
</tr>
<tr class="odd">
<td align="left"><code>61</code>-<code>6F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"><code>70</code></td>
<td align="left">Unspecified Space Vehicle</td>
<td align="left">An object for transport in space</td>
</tr>
<tr class="odd">
<td align="left"><code>71</code>-<code>7F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"><code>80</code></td>
<td align="left">Unspecified goods</td>
<td align="left">Movable materiel, goods, cargo, supplies, etc.</td>
</tr>
<tr class="odd">
<td align="left"><code>80</code>-<code>8F</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="even">
<td align="left"><code>90</code>-<code>EF</code></td>
<td align="left">(reserved)</td>
</tr>
<tr class="odd">
<td align="left"><code>F0</code>-<code>FF</code></td>
<td align="left">(private use)</td>
<td align="left">Private use, i.e. not standardized</td>
</tr>
</tbody>
</table>
<p>The table below shows which object types may be used for which message subjects, and which combinations types are not allowed.</p>
<table>
<colgroup>
<col width="30%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Subject Code &amp; Object Code</th>
<th align="left"><code>10</code>-<code>1F</code> Persons</th>
<th align="left"><code>20</code>-<code>2F</code> Areas</th>
<th align="left"><code>30</code>-<code>3F</code> Structures</th>
<th align="left"><code>40</code>-<code>7F</code> Vehicles</th>
<th align="left"><code>80</code>-<code>8F</code> Goods</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>P01</code>-<code>P0F</code> White Flag Protective Signs</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>P10</code>-<code>P1F</code> Red Cr* Protective Signs</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
</tr>
<tr class="odd">
<td align="left"><code>P20</code>-<code>P2F</code> UN Protective Signs</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
</tr>
<tr class="even">
<td align="left"><code>P30</code>-<code>P3F</code> Protected Zones</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>P40</code>-<code>P4F</code> Civil Defence Protective Signs</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
</tr>
<tr class="even">
<td align="left"><code>P50</code>-<code>P5F</code> Cultural Property Protective Signs</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
</tr>
<tr class="odd">
<td align="left"><code>P60</code>-<code>P6F</code> Dangerous Forces Protective Signs</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">X</td>
<td align="left">allowed</td>
</tr>
<tr class="even">
<td align="left"><code>E00</code>-<code>EFF</code> Emergency Signals</td>
<td align="left">allowed</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>D00</code>-<code>D1F</code> Attack Danger Signs</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
</tr>
<tr class="even">
<td align="left"><code>D20</code>-<code>D2F</code> Danger Area Signs</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>D30</code>-<code>D4F</code> Accident Danger Signs</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>D50</code>-<code>D5F</code> Uncontrolled Danger Signs</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>DA0</code>-<code>DFF</code> Disasters</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>S00</code>-<code>S0F</code> Generic Status Signals</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
</tr>
<tr class="odd">
<td align="left"><code>S10</code>-<code>S1F</code> Proof-of-life Status Signals</td>
<td align="left">allowed</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>S20</code>-<code>S2F</code> Object Status Signals</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
</tr>
<tr class="odd">
<td align="left"><code>I00</code>-<code>IEF</code> Infrastructures</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>M00</code>-<code>MEF</code> Missions</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
<td align="left">allowed</td>
</tr>
<tr class="odd">
<td align="left"><code>Q10</code>-<code>Q2F</code> Requests</td>
<td align="left">X</td>
<td align="left">allowed</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
</tbody>
</table>
<h4 id="object-location-fields">4.3.1.6 Object Location Fields</h4>
<p>The <code>ObjectLatitude</code> and <code>ObjectLongitude</code> fields specify the location of <em>the centre of the object on, or projected on, the earth's surface</em> in decimal degrees latitude and decimal degrees longitude, using the WGS84 datum (i.e. EPSG:4326). The vertical location (height or depth) cannot be provided.</p>
<p>Based on ISO 6709 - Standard representation of geographic point location by coordinates, the <code>ObjectLatitude</code> fields must be formatted as follows: <code>\_dd.ddddd</code> (i.e. regular expression <code>\^\[+-\]\[0-9\]{2}\\.\[0-9\]{5}\$</code>), where:</p>
<ul>
<li><p>The digits represent the north-south longitude; valid values are: <code>-90.00000</code> to +<code>90.00000</code></p></li>
<li><p><code>\_</code> is either <code>+</code> or <code>-</code> to denote north (+) or south (-).</p></li>
</ul>
<p>Based on ISO 6709 - Standard representation of geographic point location by coordinates, the <code>ObjectLongitude</code> fields must be formatted as follows: <code>\_ddd.ddddd</code> (i.e. regular expression <code>\^\[+-\]\[0-9\]{3}\\.\[0-9\]{5}\$</code>), where:</p>
<ul>
<li><p>The digits represent the east-west latitude; valid values are: <code>-180.00000</code> to <code>+180.00000</code></p></li>
<li><p><code>\_</code> is either <code>+</code> or <code>-</code> to denote east (+) or west (-).</p></li>
</ul>
<p>The object location must be specified for Protective Signs and Danger Signs (Message Codes <code>P</code> and <code>D</code>).</p>
<p>The object location may be used for Emergency Signals and Status Signals (Message Codes <code>E</code> and <code>S</code>), e.g. for security reasons. If the object location is omitted, the coordinates must be set to the following value: <code>+99.99999+999.99999</code>.</p>
<p>The object location may not be omitted in a Status Signal (Message Code <code>S</code>) referencing a Protective Sign or a Danger Sign (Message Code <code>P</code> or <code>D</code>).</p>
<h4 id="object-size-fields">4.3.1.7 Object Size Fields</h4>
<p>The <code>ObjectSizeDim1</code> and <code>ObjectSizeDim2</code> fields may be used to specify the horizontal surface dimensions of areas and structures in meters. Valid values are: <code>0001</code> to <code>9999</code>. The value of a dimension that is omitted, must be set to <code>0000</code>.</p>
<p>For (groups of) persons (Object Codes <code>10</code>-<code>1F</code>), the Object Size may be provided. The Object Size represents the area in which the person(s) is/are located. The area must be defined as small as possible.</p>
<p>For shaped areas and structures (Object Codes <code>21-2F</code> and <code>31-3F</code>), the Object Size must be provided. For unspecified areas and structures (Object Codes <code>20</code> and <code>30</code>) the dimensions are by definition unknown, and must be omitted. For all other objects, the Object Size must be omitted.</p>
<p>For circle shaped areas and structures (Object Codes <code>21</code> and <code>31</code>), the <code>ObjectSizeDim1</code> field represents the radius; the <code>ObjectSizeDim2</code> field has no meaning for circle shaped areas and structures and must be omitted.</p>
<p>For rectangle shaped areas and structures (Object Codes <code>22</code> and <code>32</code>), the <code>ObjectSizeDim1</code> field represents the length of the side for which the orientation is specified with the Object Orientation Field; the <code>ObjectSizeDim2</code> field represents the other side.</p>
<p>Triangle shaped areas and structures (Object Codes <code>23</code> and <code>33</code>) are isosceles triangles, with the <code>ObjectSizeDim1</code> field representing the triangle height and the ObjectSizeDim2 represents the base.</p>
<h4 id="object-orientation-field">4.3.1.8 Object Orientation Field</h4>
<p>The <code>ObjectOrientation</code> field may be used to specify the orientation of the object in decimal degrees, where <code>000</code> means North.</p>
<p>Valid values are: <code>000</code> to <code>359</code>. If the object's orientation is omitted, the field value must be set to <code>999</code>.</p>
<p>If an Object Size is specified using the <code>ObjectSizeDim1</code> and <code>ObjectSizeDim2</code> fields, then the <code>ObjectOrientation</code> field must be specified as well. If the Object Size is not specified, then the Object Orientation must be omitted.</p>
<h4 id="object-request-fields">4.3.1.9 Object Request Fields</h4>
<p>The object request fields <code>ObjectType*</code> and <code>ObjectType*Quant</code> may only be used in <code>Q</code> messages and must be used together, with the object type field before the quantity field.</p>
<p>These fields may be repeated up to seven (7) times, giving a maximum of eight (8) objects with their respective quantity.</p>
<p>The <code>ObjectType*</code> field contains a hexadecimal code to indicate what sort of object the request applies to. The values correspond with those of the <code>ObjectType</code> field as specified in 4.3.1.5, with the following restrictions:</p>
<ul>
<li><p>when referring to persons, the exact number of person must be specified and therefore the <code>12</code>-<code>1F</code> may not be used;</p></li>
<li><p>unmovable objects, i.e. <code>20</code>-<code>2F</code> areas and <code>30</code>-<code>3F</code> structures,may not be used.</p></li>
</ul>
<p>Note that in accordance with 4.3.1.5, the object code of a <code>Q</code> message itself must represent an area, i.e. code <code>20</code>-<code>2F</code>.</p>
<p>Valid values for an <code>ObjectType*Quant</code> field are <code>00</code> to <code>99</code>. If the quantity of an object is unknown, then the respective <code>ObjectType*Quant</code> field must be <code>00</code>.</p>
<h3 id="functional-messages-resource">4.3.2 Functional Messages: Resource</h3>
<h4 id="resource-message-fields">4.3.2.1 Resource Message Fields</h4>
<table>
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="15%" />
<col width="26%" />
<col width="17%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Byte Index</th>
<th align="left">Byte Length</th>
<th align="left">Field</th>
<th align="left">Usage</th>
<th align="left">Uncompressed Encoding</th>
<th align="left">Compressed Encoding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0-70</td>
<td align="left">71</td>
<td align="left">Message Header</td>
<td align="left">See Generic Message Header Fields</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">71</td>
<td align="left">1</td>
<td align="left"><code>ResourceMethod</code></td>
<td align="left">Indicates the mechanism for pointing to a resource</td>
<td align="left"><code>x</code></td>
<td align="left">1x 4-bit unsigned binary coded hexadecimal</td>
</tr>
<tr class="odd">
<td align="left">72-111*</td>
<td align="left">40*</td>
<td align="left"><code>ResourceData</code></td>
<td align="left">Provides the data required to find the resource</td>
<td align="left"><code>cccccccccc ... cccccccccc</code></td>
<td align="left">40x 8-bit UTF-8</td>
</tr>
</tbody>
</table>
<h4 id="resource-method-field">4.3.2.2 Resource Method Field</h4>
<p>The <code>ResourceMethod</code> field defines the mechanism for pointing to a resource. The field must be 1-byte UTF-8 encoded hexadecimal character. Currently only one resource method has been defined:</p>
<table>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Resource Method</th>
<th align="left">Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>0</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used</td>
</tr>
<tr class="even">
<td align="left"><code>1</code></td>
<td align="left"><code>InternetResource</code></td>
<td align="left">Reference to an internet resource</td>
</tr>
<tr class="odd">
<td align="left"><code>2</code>-<code>9</code></td>
<td align="left">(reserved)</td>
<td align="left">Reserved for future resource referencing mechanisms</td>
</tr>
<tr class="even">
<td align="left"><code>A</code>-<code>F</code></td>
<td align="left">(private use)</td>
<td align="left">Private use, i.e. not standardized</td>
</tr>
</tbody>
</table>
<h4 id="resource-data-field">4.3.2.3 Resource Data Field</h4>
<p>The content of the ResourceData field depends on the resource method:</p>
<ul>
<li>If the <code>ResourceMethod</code> method indicates a reference to an internet resource (resource method 1), then the <code>ResourceData</code> field must contain a valid URL.</li>
</ul>
<p>The <code>ResourceData</code> field may be longer than 40 bytes, if allowed by underlying blockchain. If the length of the <code>ResourceData</code> field is insufficient to provide the complete URL, an additional Reference Message may be sent with the rest of the URL using reference code <code>3</code>.</p>
<h3 id="functional-messages-free-text">4.3.3 Functional Messages: Free Text</h3>
<h4 id="free-text-message-fields">4.3.3.1 Free Text Message Fields</h4>
<table>
<thead>
<tr class="header">
<th align="left">Byte Index</th>
<th align="left">Byte Length</th>
<th align="left">Field</th>
<th align="left">Usage</th>
<th align="left">Uncompressed Encoding</th>
<th align="left">Compressed Encoding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0-70</td>
<td align="left">71</td>
<td align="left">Message Header</td>
<td align="left">See Generic Message Header Fields</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">72-111*</td>
<td align="left">40*</td>
<td align="left"><code>Text</code></td>
<td align="left">Free text</td>
<td align="left"><code>cccccccccc ... cccccccccc</code></td>
<td align="left">40x 8-bit UTF-8</td>
</tr>
</tbody>
</table>
<h4 id="text-field">4.3.3.2 Text Field</h4>
<p>The <code>Text</code> field can be used to send 40x 1-byte UTF-8 encoded text, typically to provide additional information about a sign or signal, using reference code <code>3</code> or <code>5</code>.</p>
<p>The <code>Text</code> field may be longer than 40 bytes, if allowed by underlying blockchain. If the length of the <code>Text</code> field is insufficient to provide all text, an additional text message may be sent using reference code <code>3</code>.</p>
<h3 id="management-messages-authentication">4.3.4 Management Messages: Authentication</h3>
<h4 id="authentication-message-fields">4.3.4.1 Authentication Message Fields</h4>
<p>The message body of management messages for (initial) authentication (message type <code>A</code>), must contain the following fields:</p>
<table style="width:100%;">
<colgroup>
<col width="9%" />
<col width="9%" />
<col width="15%" />
<col width="25%" />
<col width="17%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Byte Index</th>
<th align="left">Byte Length</th>
<th align="left">Field</th>
<th align="left">Usage</th>
<th align="left">Uncompressed Encoding</th>
<th align="left">Compressed Encoding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0-70</td>
<td align="left">71</td>
<td align="left">Message Header</td>
<td align="left">See Generic Message Header Fields</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">71</td>
<td align="left">1</td>
<td align="left"><code>VerificationMethod</code></td>
<td align="left">Indicates the authentication mechanism</td>
<td align="left"><code>x</code></td>
<td align="left">1x 4-bit unsigned binary coded hexadecimal</td>
</tr>
<tr class="odd">
<td align="left">72-111*</td>
<td align="left">40*</td>
<td align="left"><code>VerificationData</code></td>
<td align="left">Provides the data required for authentication</td>
<td align="left"><code>cccccccccc ... cccccccccc</code></td>
<td align="left">25x 8-bit UTF-8</td>
</tr>
</tbody>
</table>
<h4 id="verification-method-field">4.3.4.2 Verification Method Field</h4>
<p>The <code>VerificationMethod</code> field defines the mechanism for authentication of the blockchain address and related account, and must be a 1-byte UTF-8 encoded hexadecimal character from the following table with codes for each verification method:</p>
<table>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Verification Method</th>
<th align="left">Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>0</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used</td>
</tr>
<tr class="even">
<td align="left"><code>1</code></td>
<td align="left"><code>InternetResource</code></td>
<td align="left">Authentication through an internet resource</td>
</tr>
<tr class="odd">
<td align="left"><code>2</code></td>
<td align="left"><code>SharedToken</code></td>
<td align="left">Authentication by a secret pre-shared token</td>
</tr>
<tr class="even">
<td align="left"><code>3</code>-<code>9</code></td>
<td align="left">(reserved)</td>
<td align="left">Reserved for future authentication mechanisms</td>
</tr>
<tr class="odd">
<td align="left"><code>A</code>-<code>F</code></td>
<td align="left">(private use)</td>
<td align="left">Private use, i.e. not standardized</td>
</tr>
</tbody>
</table>
<h4 id="verification-data-field">4.3.4.3 Verification Data Field</h4>
<p>The content of the <code>VerificationData</code> field depends on the verification method:</p>
<ul>
<li><p>If the <code>InternetResource</code> method is specified (verification method 1), then the VerificationData field must contain a valid URL;</p></li>
<li><p>If the <code>SharedToken</code> method is specified (verification method 2), then the VerificationData field must contain the verification token.</p></li>
</ul>
<p>The <code>VerificationData</code> field may be longer than 40 bytes, if allowed by underlying blockchain. If the length of the <code>VerificationData</code> field is insufficient to provide the complete URL or verification token, an additional Authentication Message may be sent with the rest of the URL or verification token using reference code <code>3</code>.</p>
<h3 id="management-messages-cryptographic-support">4.3.5 Management Messages: Cryptographic Support</h3>
<h4 id="cryptographic-support-message-fields">4.3.5.1 Cryptographic Support Message Fields</h4>
<p>The message body of management messages for cryptographic support (message type <code>K</code>), must contain the following fields:</p>
<table style="width:100%;">
<colgroup>
<col width="9%" />
<col width="9%" />
<col width="15%" />
<col width="25%" />
<col width="17%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Byte Index</th>
<th align="left">Byte Length</th>
<th align="left">Field</th>
<th align="left">Usage</th>
<th align="left">Uncompressed Encoding</th>
<th align="left">Compressed Encoding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0-70</td>
<td align="left">71</td>
<td align="left">Message Header</td>
<td align="left">See Generic Message Header Fields</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">71-72</td>
<td align="left">2</td>
<td align="left"><code>CryptoDataType</code></td>
<td align="left">Indicates the type of data in this message</td>
<td align="left"><code>xx</code></td>
<td align="left">2x 4-bit unsigned binary coded hexadecimal</td>
</tr>
<tr class="odd">
<td align="left">73-144*</td>
<td align="left">80*</td>
<td align="left"><code>CryptoData</code></td>
<td align="left">Contains the cryptographic data</td>
<td align="left"><code>xxxxxxxxxx ... xxxxxxxxxx</code></td>
<td align="left">128x 4-bit unsigned binary coded hexadecimal</td>
</tr>
</tbody>
</table>
<h4 id="cryptographic-data-type-field">4.3.5.2 Cryptographic Data Type Field</h4>
<p>The <code>CryptoDataType</code> field defines the type of cryptographic key data to be exchanged, and must be a 2-byte UTF-8 encoded hexadecimal character from the following table with codes for each key type:</p>
<table>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Crypto Data Type</th>
<th align="left"><code>CryptoData</code> field usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>00</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used; reserved for future use</td>
</tr>
<tr class="even">
<td align="left"><code>01</code></td>
<td align="left"><code>HDExtPubKey</code></td>
<td align="left">Serialised hierarchical deterministic extended public key</td>
</tr>
<tr class="odd">
<td align="left"><code>02</code>-<code>09</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used; reserved for future use</td>
</tr>
<tr class="even">
<td align="left"><code>0A</code></td>
<td align="left"><code>ECDHPubKey</code></td>
<td align="left">Elliptic Curve DiffieHellman public key exchange</td>
</tr>
<tr class="odd">
<td align="left"><code>0B</code>-<code>0F</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used; reserved for future use</td>
</tr>
<tr class="even">
<td align="left"><code>10</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used; reserved for future use</td>
</tr>
<tr class="odd">
<td align="left"><code>11</code></td>
<td align="left"><code>InitVector</code></td>
<td align="left">Initialisation Vector for encryption method <code>1</code></td>
</tr>
<tr class="even">
<td align="left"><code>12</code>-<code>1F</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used; reserved for future use</td>
</tr>
<tr class="odd">
<td align="left"><code>20</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used; reserved for future use</td>
</tr>
<tr class="even">
<td align="left"><code>21</code></td>
<td align="left"><code>InitVector</code></td>
<td align="left">Initialisation Vector for encryption method <code>2</code></td>
</tr>
<tr class="odd">
<td align="left"><code>22</code>-<code>2F</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used; reserved for future use</td>
</tr>
<tr class="even">
<td align="left"><code>20</code>-<code>99</code></td>
<td align="left">(reserved)</td>
<td align="left">Must not be used; reserved for future encryption features</td>
</tr>
<tr class="odd">
<td align="left"><code>A0</code>-<code>FF</code></td>
<td align="left">(private use)</td>
<td align="left">Private use, i.e. not standardized</td>
</tr>
</tbody>
</table>
<h4 id="cryptographic-data-field">4.3.5.3 Cryptographic Data Field</h4>
<p>The content of the <code>CryptoData</code> field is determined by the <code>CryptoDataType</code> field value as follows.</p>
<ul>
<li><p>When the data type is <code>HDExtPubKey</code> (code <code>01</code>), the data field must contain the serialised extended public key used to derive the deterministic public keys (and addresses).</p></li>
<li><p>When the data type is <code>ECDHPubKey</code> (code <code>0A</code>), the data field must contain a compressed elliptic curve public key for a Diffie-Hellman key exchange.</p></li>
<li><p>When the data type is <code>InitVector</code> (code <code>11</code> or <code>21</code>), the data field must contain the 128-bit initialisation vector required to decrypt a message encrypted with the algorithm indicated with encryption indicator code <code>1</code> and <code>2</code> respectively.</p></li>
</ul>
<p>The <code>CryptoData</code> field may be longer than 64 bytes if allowed by underlying blockchain. If the length of the <code>CryptoData</code> field is insufficient to provide the full data, an additional Cryptographic Support Messages may be sent with the rest of the key data using reference code <code>3</code>.</p>
<p>Usage of the Cryptographic Support Message and the data types is detailed in 5.2 Cryptographic Support Functions.</p>
<h3 id="management-messages-test">4.3.6 Management Messages: Test</h3>
<h4 id="test-message-fields">4.3.6.1 Test Message Fields</h4>
<p>The message body of test messages has an identical set of fields as signs &amp; signals messages have, which allows to test sign and signals. A test message must contain the following fields:</p>
<table style="width:100%;">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="19%" />
<col width="27%" />
<col width="14%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Byte Index</th>
<th align="left">Byte Length</th>
<th align="left">Field</th>
<th align="left">Usage</th>
<th align="left">Uncompressed Encoding</th>
<th align="left">Compressed Encoding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0-70</td>
<td align="left">71</td>
<td align="left">Message Header</td>
<td align="left">See Generic Message Header Fields</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">71</td>
<td align="left">1</td>
<td align="left"><code>PseudoMessageCode</code></td>
<td align="left">Indicates the message type that is tested</td>
<td align="left"><code>a</code></td>
<td align="left">1x 8-bit UTF-8</td>
</tr>
<tr class="odd">
<td align="left">72</td>
<td align="left"></td>
<td align="left">Test Message Body</td>
<td align="left">See Message Body</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h4 id="pseudo-message-code">4.3.5.2 Pseudo Message Code</h4>
<p>The <code>PseudoMessageCode</code> field indicates which sign/signal message is tested. The contents of the field must be a 1-byte UTF-8 encoded alpha-numeric character value corresponding with one of the message types defined in 2.4.2 Message Functionality.</p>
<h4 id="other-test-message-fields">4.3.5.3 Other Test Message Fields</h4>
<p>All other test message fields are identical in use as the equivalent fields sign/signal message, as described in 4.3 Message Body, with the difference that the fields are shifted 1 byte / 8 bits.</p>
<p>The field names must be preceded by <code>Test</code> when used in a test message.</p>
<h1 id="protocol">5 Protocol</h1>
<h2 id="joining-and-leaving-the-whiteflag-network">5.1 Joining and Leaving the Whiteflag Network</h2>
<h3 id="initial-authentication">5.1.1 Initial Authentication</h3>
<p>It is not required to perform initial authentication and provide identity information to receive messages.</p>
<p>To send Whiteflag Messages on the network, the originator must have at least one blockchain account and address. An originator may use multiple accounts, and an account may use multiple addresses.</p>
<p>Each account should be identified by sending an <code>A(0)</code> initial authentication message, before sending any other message. Any message sent by an account before that account has sent an <code>A(0)</code> messages, may be considered unauthenticated by recipients.</p>
<p>If an account uses multiple addresses, the <code>A(0)</code> message must be sent using the address corresponding with public key from which all other addresses can be deterministically derived. For recipients to be able to derive those address, a <code>K(3)2</code> message referencing the <code>A(0)</code> message must be sent, containing the chain code for child key derivation.</p>
<h3 id="validating-authentication-information">5.1.2 Validating Authentication Information</h3>
<h4 id="method-1-url-validation">5.1.2.1 Method 1: URL Validation</h4>
<p>The URL contained in the VerificationData field an <code>A1</code> message must point to web resource. This allows the blockchain account to be linked to a web site, social media account, or any other web resource that identifies the originator. Consequently, the identification is as strong as the web resource used.</p>
<p>The URL should use the <code>https:</code> scheme to be able to ensure the validity of the resource.</p>
<p>At the URL, a flattened JSON Web Signature JSON serialization (JWS-JS) formatted object i.a.w. RFC 7515 - JSON Web Signature (JWS) must be found. This object contains a JSON object with authentication information together with a single digital signature.</p>
<p>The digital signature is used for authentication, non-reputation and data integrity. In other words: it ensures that only the owner of the web resource controls the blockchain account used to send the <code>A</code> message. The digital signature must be created using the key pair of the associated blockchain account, i.e. the account from which the <code>A1</code> message has been sent.</p>
<p>The non-serialised payload with authentication information must be a JSON object itself and must at least have the following properties: the originator's blockchain address, the originator's name, and the same URL as in the A message, as follows:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json">    <span class="er">&quot;protected&quot;:</span> <span class="fu">{</span>
        <span class="dt">&quot;addr&quot;</span><span class="fu">:</span> <span class="st">&quot;...&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;orgname&quot;</span><span class="fu">:</span> <span class="st">&quot;...&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;url&quot;</span><span class="fu">:</span> <span class="st">&quot;...&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;extpubkey&quot;</span><span class="fu">:</span> <span class="st">&quot;...&quot;</span>
    <span class="fu">}</span></code></pre></div>
<p>in which:</p>
<ul>
<li><p><code>addr</code> is the same blockchain address used to send the corresponding <code>A1</code> message and of which the corresponding private key is used to create the signature;</p></li>
<li><p><code>orgname</code> is the name of the originator, which can be chosen freely;</p></li>
<li><p><code>url</code> is exactly the same URL as in the <code>VerificationData</code> field the corresponding <code>A1</code> message.</p></li>
</ul>
<p>If the originator uses deterministic keys and addresses, the payload must also contain information to derive the public keys:</p>
<ul>
<li><code>extpubkey</code> is the serialised extended parent public key from which the child public keys and addresses used by this originator can be derived.</li>
</ul>
<p>The serialisation format of an extended public key is blockchain specific. Although supported, deterministic keys should normally not be used.</p>
<p>An example for usage of JWS for authentication is included in Annex C.</p>
<h4 id="method-2-shared-token-validation">5.1.2.2 Method 2: Shared Token Validation</h4>
<p>The option to use a secret token for authentication allows the issuer of the token to authenticate the originator's blockchain account when the token is revealed in an <code>A2</code> message. The secret token may be pre-shared or generated from a shared secret:</p>
<ol style="list-style-type: decimal">
<li><p>The token may be a secret piece of either arbitrary data or some (encrypted) meaningful data provided to the originator.</p></li>
<li><p>The token may also be derived from an ECDH shared secret as described in 5.2.3 Key and Token Derivation.</p></li>
</ol>
<p>The secret token must not be used directly in a single <code>A2(0)</code> message. Instead, the authentication data sent in the <code>A2(0)</code> message must be derived from the secret token using the HKDF function defined in RFC 5869. The procedure is described in detail in the Key and Token Derivation paragraph.</p>
<p>An originator may use multiple <code>A2(0)</code> messages with tokens from different issuers or ECDH counterparts.</p>
<p>The issuer or ECDH counterparts may send <code>A2(6)</code> or <code>A2(7)</code> messages to confirm or acknowledge the claim, but also may choose not to do so to prevent others to record metadata on communications between parties.</p>
<h3 id="additional-authentication-information">5.1.3 Additional Authentication Information</h3>
<p>Multiple tokens, URL verifications, or combinations thereof, may be sent for stronger authentication by sending multiple <code>A(0)</code> messages.</p>
<p>The authentication information in an <code>A(0)</code> or <code>A(2)</code> message may be updated with an <code>A(2)</code> message.</p>
<p>An <code>A(3)</code> message must be used when providing longer URLs or tokens than a single message <code>A(0)</code> or <code>A(2)</code> message can contain in its <code>VerificationData</code> field.</p>
<h3 id="leaving-the-network">5.1.4 Leaving the Network</h3>
<p>An account may leave the network with an <code>A(4)</code> message referencing, and thus discontinuing, each <code>A(0)</code> message that has been sent earlier. Any message sent by an account after that account has discontinued all its <code>A(0)</code> messages, should be considered unauthenticated.</p>
<h2 id="cryptographic-support-functions">5.2 Cryptographic Support Functions</h2>
<h3 id="hierarchical-deterministic-accounts-and-addresses">5.2.1 Hierarchical Deterministic Accounts and Addresses</h3>
<p>It may not be assumed that every recipient is able to link deterministically derived addresses to the master public key of the account in order to authenticate the originator.</p>
<h3 id="key-agreement">5.2.2 Key Agreement</h3>
<p>The protocol supports cryptographic key exchange using Elliptic Curve Diffie-Hellman (ECDH), which is an Elliptic Curve variant of the standard Diffie-Hellman algorithm. This well known algorithm allows two parties, that do not have any prior knowledge of each other, to agree on a shared secret using an open communication channel. This shared secret may then be used, for example, to derive a secret key for the encryption of messages.</p>
<p>The OpenSSL implementation of ECDH is the reference implementation for for Elliptic Curve Diffie-Hellman key agreement with the Whiteflag Protocol. The elliptic curve parameters that must be used for Whiteflag are defined by the <code>brainpoolP256r1</code> curve as specified in RFC 5639.</p>
<p>Any participant may generate a 264-bit compressed public ECDH key and publish the key on the Whiteflag network using a <code>K(0)0A</code> message. This allows any two participants, who have both published their public key, to generate the shared secret using their own private key and the other's public key.</p>
<p>If one of the participants publishes an <code>K(2)0A</code> message with updated key, the existing shared secrets with other participants expire and new shared secrets must be generated for and by each other participant.</p>
<p>Only one single participant's public ECDH key is considered valid at any point in time. Nevertheless, multiple <code>K(0)0A</code> messages may be sent to republish the public key. If a subsequent <code>K(0)0A</code> message contains a different public key, this must be interpreted as an <code>K(2)0A</code> message with an updated key (which should have been sent instead).</p>
<p>The shared secret may be used as a basis for encryption and authentication, whether for Whiteflag or not, but it should never be used directly as an encryption key.</p>
<h3 id="key-and-token-derivation">5.2.3 Key and Token Derivation</h3>
<p>Shared secrets (such as pre-shared, deterministically derived or ECDH generated secrets), must use the HKDF function defined in RFC 5869 to derive the actual tokens and encryption keys used for Whiteflag.</p>
<p>Note that it is crucial for security that shared secrets used as the input keying material for HKDF, have enough entropy, i.e. are sufficiently long (at least 16 bytes) and are practically indistinguishable from random data.</p>
<p>The HKDF function must use SHA-256 as the digest algorithm. Furthermore, the HKDF function takes three (3) parameters depending on the encryption method or token type: the key/token length, a usage specific salt and the the blockchain address as the info value.</p>
<ul>
<li>for authentication method 2 (token-based):
<ol style="list-style-type: decimal">
<li>the key length (token length) must be 32 bytes (256 bits)</li>
<li>the salt value must be (hexadecimal): <code>420abc48f5d69328c457d61725d3fd7af2883cad8460976167e375b9f2c14081</code></li>
<li>the info value must be the binary blockchain address</li>
</ol></li>
<li>for encryption method 1 (<code>aes-256-ctr</code> with negotiated secret):
<ol style="list-style-type: decimal">
<li>the key length must be 32 bytes (256 bits)</li>
<li>the salt value must be (hexadecimal): <code>8ddb03085a2c15e69c35c224bce2952dca7878770724741cbce5a135328be0c0</code></li>
<li>the info value must be the binary blockchain address</li>
</ol></li>
<li>for encryption method 2 (<code>aes-256-ctr</code> with pre-shared secret):
<ol style="list-style-type: decimal">
<li>the key length must be 32 bytes (256 bits)</li>
<li>the salt value must be (hexadecimal): <code>c4d028bd45c876135e80ef7889835822a6f19a31835557d5854d1334e8497b56</code></li>
<li>the info value must be the binary blockchain address</li>
</ol></li>
</ul>
<p>Note that the salts are shown above in hexadecimal representation. Implementations must ensure that the data is correctly provided to the HKDF function, i.e. as binary information, not as a string. This is especially important for blockchains addresses, which appear in different encodings.</p>
<p>Using the 2.4.2.2 blockchain address <code>1C8KSK68SJjfDSBx9BpSx3qB3bePf23r77</code> as an example, this results in the following pseudocode for deriving authentication tokens:</p>
<pre class="pseudocode"><code>    tokenlength := 32
    salt := 0x420abc48f5d69328c457d61725d3fd7af2883cad8460976167e375b9f2c14081
    info := 0x007a0baf6f84f0fa7402ea972686e56d50b707c9b67b108866
    secretToken := HKDF(sharedSecret, salt, info, tokenlength, digest=&quot;sha256&quot;)</code></pre>
<p>The pseudocode for deriving encryption/decryption keys for the same blockchain address is as follows:</p>
<pre class="pseudocode"><code>    if (EncryptionIndicator == 1) then:
        keylength := 32
        salt := 0x8ddb03085a2c15e69c35c224bce2952dca7878770724741cbce5a135328be0c0
        info := 0x007a0baf6f84f0fa7402ea972686e56d50b707c9b67b108866
    if (EncryptionIndicator == 2) then:
        keylength := 32
        salt := 0xc4d028bd45c876135e80ef7889835822a6f19a31835557d5854d1334e8497b56
        info := 0x007a0baf6f84f0fa7402ea972686e56d50b707c9b67b108866
    key := HKDF(sharedSecret, salt, info, keylength, digest=&quot;sha256&quot;)</code></pre>
<h3 id="message-encryption">5.2.4 Message Encryption</h3>
<p>Two encryption methods are currently defined by Whiteflag: the Advanced Encryption Standard (AES) using a 256-bit key in counter mode (CTR) with either an ECDH negotiated secret (method 1) or a pre-shared secret (method 2).</p>
<p>AES is a symmetric cipher that requires the same key for encryption and decryption. This key must be derived as described in the Key and Token Derivation paragraph.</p>
<h4 id="encryption-methods-1-and-2">5.2.4.1. Encryption Methods 1 and 2</h4>
<p>Encryption methods 1 and 2 only differ in the key used for the encryption:</p>
<ul>
<li><p>Encryption method 1 uses the ECDH negotiated secret as described in the Key Agreement paragraph to derive the encryption key. This method can therefore only been used to send encrypted messages between the two blockchain accounts that have negotiated the shared secret.</p></li>
<li><p>Encryption method 2 uses a pre-shared secret to derive the encryption key. It is outside the scope of this standard to define the key management and distribution of pre-shared keys. However, it is important for security that the pre-shared secret is sufficiently long and random.</p></li>
</ul>
<p>Encryption of a Whiteflag message is performed with the following steps:</p>
<ul>
<li><p>derive the encryption key respectively from an ECDH negotiated secret or a pre-shared secret using the HKDF function as described in the the Key and Token Derivation paragraph;</p></li>
<li><p>generate a unique 128-bit initialisation vector, e.g. with cryptographically secure random number generator;</p></li>
<li><p>encrypt the compressed binary encoded message starting at bit 32 (the 33th bit) up to and including the last bit, using <code>aes-256-ctr</code> with the appropriate key and the just generated initialisation vector.</p></li>
</ul>
<p>Below are the encryption steps in pseudocode, in which the key has already been derived as described in 5.2.3 Key and Token Derivation:</p>
<pre class="pseudocode"><code>    iv := generateRandomBits(128)
    encryptedMessagePart := aes(encodedMessage[32...n], key, iv, mode=&quot;ctr&quot;)
    encryptedMessage := encodedMessage[0...31] + encryptedMessagePart</code></pre>
<p>The OpenSSL implementation of AES is the reference implementation for the usage of AES to encrypt and decrypt Whiteflag messages.</p>
<p>AES in counter mode requires a different initialisation vector for each message encryption, especially when reusing the same key. Therefore, a new random initialisation vector must be created for each message to be encrypted.</p>
<p>The encrypted message, with the correct encryption indicator set and the plaintext from the 5th byte onwards replaced with the ciphertext, must be sent as any other Whiteflag message.</p>
<p>The encrypted message must immediately be followed and referenced by a <code>K(3)11</code> or a <code>K(3)21</code> message containing the initialisation vector. Without the initialisation vector the message cannot be decrypted by the recipient. The <code>K</code> message must not be encrypted itself, and the duress indicator must be <code>0</code>, regardless of the duress indicator value of the referenced encrypted message.</p>
<h2 id="sending-stand-alone-signs-and-signals">5.3 Sending stand-alone Signs and Signals</h2>
<p>To send a stand-alone message, Reference Code <code>0</code> must be used.</p>
<p>However, nothing prevents other senders to reference the message at any later point in time, thus creating a message sequence from a previously stand-alone message.</p>
<p>A message is sent by embedding it in a blockchain transaction. The way this is done is blockchain specific. Annex A contains some information about message embedding for a limited number of blockchains.</p>
<h2 id="referencing">5.4 Referencing</h2>
<h3 id="reference-options">5.4.1 Reference Options</h3>
<h4 id="allowed-referencing-between-message-types">5.4.1.1 Allowed Referencing between Message Types</h4>
<p>The table below shows which references types (as defined in Reference Indicator Field) may be used between the different message types, and which reference types are not allowed.</p>
<table>
<thead>
<tr class="header">
<th align="left">Referencing Message</th>
<th align="left"><code>P</code></th>
<th align="left"><code>E</code></th>
<th align="left"><code>D</code></th>
<th align="left"><code>S</code></th>
<th align="left"><code>I</code></th>
<th align="left"><code>Q</code></th>
<th align="left"><code>M</code></th>
<th align="left"><code>F</code></th>
<th align="left"><code>R</code></th>
<th align="left"><code>A</code></th>
<th align="left"><code>K</code></th>
<th align="left"><code>T</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>P</code></td>
<td align="left">1/2/3/4/6/7/8/9</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">3/5</td>
<td align="left">X</td>
<td align="left">3/5</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>E</code></td>
<td align="left">X</td>
<td align="left">1/2/3/4/6/7</td>
<td align="left">3/5</td>
<td align="left">5</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">5</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>D</code></td>
<td align="left">5</td>
<td align="left">X</td>
<td align="left">1/2/3/4/6/7/9</td>
<td align="left">X</td>
<td align="left">5</td>
<td align="left">X</td>
<td align="left">5</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>S</code></td>
<td align="left">3/5</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">1/2/4/6/7</td>
<td align="left">3/5</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>I</code></td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">1/2/3/4/6/7</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>Q</code></td>
<td align="left">X</td>
<td align="left">5</td>
<td align="left">5</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">1/2/3/4/7/8/9</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>M</code></td>
<td align="left">X</td>
<td align="left">5</td>
<td align="left">5</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">3</td>
<td align="left">1/2/3/4/7</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>F</code></td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">1/2/3/4</td>
<td align="left">3</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>R</code></td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">1/2/3/4</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>A</code></td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">1/2/3/4/6/7</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>K</code></td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">1/2/3/4</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>T</code></td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">T</td>
</tr>
</tbody>
</table>
<p><em>X</em>: prohibited <em>T</em>: a test message may make any reference for testing purposes</p>
<h4 id="allowed-referencing-between-reference-types">5.4.1.2 Allowed Referencing between Reference Types</h4>
<p>The table below shows which reference types (as defined in Reference Indicator Field) may be used to refer to an earlier message with a certain reference code to create a meaningful message sequence.</p>
<table>
<thead>
<tr class="header">
<th align="left">Referencing Message Code</th>
<th align="left"><code>0</code></th>
<th align="left"><code>1</code></th>
<th align="left"><code>2</code></th>
<th align="left"><code>3</code></th>
<th align="left"><code>4</code></th>
<th align="left"><code>5</code></th>
<th align="left"><code>6</code></th>
<th align="left"><code>7</code></th>
<th align="left"><code>8</code></th>
<th align="left"><code>9</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>0</code></td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>1</code></td>
<td align="left">Same</td>
<td align="left">Same</td>
<td align="left">Same</td>
<td align="left">Same</td>
<td align="left">Same</td>
<td align="left">Same</td>
<td align="left">Same</td>
<td align="left">Same</td>
<td align="left">Same</td>
<td align="left">Same</td>
</tr>
<tr class="odd">
<td align="left"><code>2</code></td>
<td align="left">Same</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">Same</td>
<td align="left">X</td>
<td align="left">Same</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>3</code></td>
<td align="left">Same</td>
<td align="left">X</td>
<td align="left">Same</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">Same</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>4</code></td>
<td align="left">Same</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">Same</td>
<td align="left">Same</td>
<td align="left">X</td>
<td align="left">Same</td>
<td align="left">Same</td>
</tr>
<tr class="even">
<td align="left"><code>5</code></td>
<td align="left">Both</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">Both</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left"><code>6</code></td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">Other</td>
<td align="left">Other</td>
<td align="left">Other</td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>7</code></td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">Other</td>
<td align="left">Other</td>
</tr>
<tr class="odd">
<td align="left"><code>8</code></td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left"><code>9</code></td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
</tbody>
</table>
<p><em>Same</em>: reference code allowed by the <em>same</em> originator of the referenced message <em>Other</em>: reference code allowed by an <em>other</em> originator than of the referenced message <em>Both</em>: reference code is allowed by <em>both</em> the same or an other originator than of the referenced message <em>X</em>: prohibited</p>
<p>A message with Reference Code <code>0</code> (an original message) may not reference any message.</p>
<p>A message with Reference Code <code>1</code> (a recall message) may reference a message with any reference code of the same originator, meaning that a message with any reference code can be recalled.</p>
<p>A message with Reference Code <code>2</code> (an update message) may only reference a message with reference code <code>0</code>, <code>3</code>, or <code>5</code> meaning that only original, additional, and referring messages may be updated and only by the same originator.</p>
<p>A message with Reference Code <code>3</code> (an additional information message) may only reference a message with reference code <code>0</code>, <code>2</code>, or <code>5</code>, for the same originator to provide additional information to original, updating and referring messages.</p>
<p>Reference Code <code>3</code> may be only used once to refer to the original message of the same message type. For example: <code>S(0) &lt; R(3) &lt; R(3)</code> and <code>... &lt; [F(3)] &lt; K11(3) &lt;&lt; [F(3)] &lt; K11(3)</code> are allowed, but <code>... &lt; R(3) &lt; R(3) &lt;&lt; R(3)</code> is not. There is one exception: Reference Code <code>3</code> may be used to reference the same message type of types <code>P</code>, <code>D</code>, <code>Q</code>, and <code>M</code> more than once, when creating composite areas (see Composite Areas and Structures). In that case, the additional information must reference the initially referenced message and may not reference another message with additional information, e.g. <code>D(0) &lt; D(3) &lt;&lt; D(3) &lt;&lt;&lt; D(3)</code></p>
<p>A message with Reference Code <code>4</code> (a discontinue message) may only reference a message with reference code <code>0</code>, <code>5</code>, <code>6</code>, <code>8</code>, or <code>9</code> of the same originator, because an only originator may only discontinue an original, related, confirmation, comply or reject message. Discontinuing a message also implies that any later updates to that message are discontinued.</p>
<p>A message with Reference Code 5 (a referring message) may only reference a message with Reference Code <code>0</code> or <code>5</code>, i.e. to refer to an original or another referencing message.</p>
<p>A message with Reference Code <code>6</code> (a confirmation message) may only reference a message with Reference Code <code>0</code>, <code>2</code>, <code>3</code>, <code>4</code>, or <code>5</code>, i.e. confirming an original, updated, additional information, expiration, or related message.</p>
<p>A message with Reference Code <code>7</code> (an acknowledgement message) may only reference may only reference a message with reference code <code>0</code>, <code>2</code>, <code>5</code>, <code>8</code> or <code>9</code>, to acknowledge an original, updated, related, comply or reject message.</p>
<p>A message with Reference Code <code>8</code> (a comply message) may only reference a message with Reference Code <code>0</code>, <code>2</code>, or <code>5</code>, i.e. to indicate the originator will act upon or in accordance with an original, updated, or a related message from another originator.</p>
<p>A message with Reference Code <code>9</code> (a reject message) may only reference a message with Reference Code <code>0</code>, <code>2</code>, or <code>5</code>, i.e. to indicate that the originator rejects, denies or does not agree with the referred original, updated, or a related message from another originator.</p>
<h3 id="message-sequences">5.4.2 Message Sequences</h3>
<p>When referencing messages are referenced themselves, message sequences may be created. The paragraphs below describe which message sequences, as allowed by the reference options described in Reference Indicator Field, provide meaningful information.</p>
<h4 id="authentication">5.4.2.1 Authentication</h4>
<p>An <code>A</code> message may only reference another <code>A</code> message, in order to:</p>
<ul>
<li><p>recall the <code>A(0)</code> message with Reference Code <code>1</code>;</p></li>
<li><p>update the <code>A(0)</code> message with Reference Code <code>2</code>, e.g. to provide new authentication information;</p></li>
<li><p>provide additional information with Reference Code <code>3</code>, when the authentication information is too long to provide in the <code>VerificationData</code> field of a single message;</p></li>
<li><p>to discontinue the original <code>A(0)</code> with an <code>A(4)</code> message, meaning the originator leaves the network;</p></li>
<li><p>to confirm the claimed identity of another originator by referencing its <code>A(0)</code> message with an <code>A(6)</code> message.</p></li>
</ul>
<p>For example, an initial authentication of originator X using an URL of 30 bytes, which is confirmed by another party Y, later updated with an URL of the same length, and finally the account is closed, will result in the following message sequence:</p>
<p><code>A01(0)X &lt; A01(3)X &lt;&lt; A01(6)Y &lt;&lt;&lt; A01(2)X &lt; A01(3)X &lt;&lt;&lt;&lt;&lt; A01(4)X</code></p>
<h4 id="updating-signs-and-signals">5.4.2.2 Updating Signs and Signals</h4>
<p>Conflicts and disasters are dynamic and events end or change. Therefore, the protocol allows to update signs and signals using message sequences with Reference Codes <code>2</code>, <code>3</code> and <code>4</code>.</p>
<p>The following example are illustrative for updating signs and signals and should be interpreted similarly when updating other signs and signals:</p>
<table>
<colgroup>
<col width="40%" />
<col width="59%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Message Sequence</th>
<th align="left">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>P10(0) &lt; P10(2) &lt;&lt; R01(3) &lt;&lt;&lt; P10(4)</code></td>
<td align="left">An original <code>P10(0)</code> message reports the presence of an ICRC-entity, which is subsequently updated with an <code>P10(2)</code> message, e.g. because the location changed. A reference is made to an ICRC-website about the entity to provide additional information using a <code>R01(3)</code> message. At a later point in time, the protective sign is withdrawn by using a <code>P10(4)</code> message to discontinue the original sign.</td>
</tr>
</tbody>
</table>
<h4 id="relating-signs-and-signals">5.4.2.3 Relating Signs and Signals</h4>
<p>Events are often related. For example, a dangerous situation such as a wildfire may cause multiple buildings to be destroyed and multiple emergencies. The protocol allows to relate the different signs and signals for these events to create a better understanding of a situation.</p>
<p>A typical sequence of message will be a danger/disaster sign, followed by one or more status and emergency signals using Reference Code <code>5</code>, which may be used to reference messages from any other account.</p>
<p>The following examples are illustrative for relating signs and signals and should be interpreted similarly when relating other signs and signals:</p>
<table>
<colgroup>
<col width="48%" />
<col width="51%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Message Sequence</th>
<th align="left">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>D32(0)X &lt; D43(5)X &lt;&lt; E12(5)X &lt;&lt; S26(5)Y &lt;&lt;&lt; S25(5)Z</code></td>
<td align="left">An original <code>D32(0)</code> message reporting a rail accident is initially referenced two times: to indicate the accident coincides with a chemical explosion with a <code>D43(5)</code> message and to make an emergency call for fire &amp; rescue assistance with a <code>E12(5)</code> message. Additional status messages relating to the accident or explosion may be sent, to report the status and locations of objects that are affected as a result of the accident or explosion.</td>
</tr>
<tr class="even">
<td align="left"><code>D15(0)X &lt; E01(5)Y &lt; E01(4)Y &lt;&lt;&lt; S11(5)Y</code></td>
<td align="left">An original message <code>D15(0)</code> reporting a complex attack is referenced by somebody sending an <code>E01(5)</code> distress signal as a result of the attack. Later, when the person is in safety, the distress signal is discontinued with an <code>E01(4)</code> message and an <code>S11(5)</code> proof of life is sent.</td>
</tr>
<tr class="odd">
<td align="left"><code>D52(0)X &lt; R01(5)A &lt;&lt; R01(5)B &lt;&lt;&lt; R01(5)C</code></td>
<td align="left">An uncontrolled uprising is reported with a <code>D52(0)</code> message, and then referenced by three <code>R01(5)</code> messages from Other Orig.nators A, B and C to point to relating internet resources such as pictures of the uprising on social media.</td>
</tr>
</tbody>
</table>
<h4 id="confirming-signs-and-signals">5.4.2.4 Confirming Signs and Signals</h4>
<p>Conflict and disaster zones are chaotic and it is often difficult to assess a situation based on a single source of information. To improve the reliability of information, the protocol allows another originator to confirm of signs and signals posted on the network using Reference Code <code>6</code>.</p>
<p>The following examples are illustrative for confirming signs and signals and should be interpreted similarly when confirming other signs and signals:</p>
<table>
<colgroup>
<col width="34%" />
<col width="65%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Message Sequence</th>
<th align="left">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>D21(0)X &lt; D21(6)Y &lt;&lt; D21(6)Z</code></td>
<td align="left">An original message reporting a minefield is confirmed two times by different originators with two <code>D21(6)</code> messages referring to the original <code>D21(0)</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>D21(0)X &lt; D21(6)Y &lt; D21(4)Y</code></td>
<td align="left">An expiration message <code>D21(4)</code> referring to a <code>D21(6)</code> confirmation message means that the original <code>D21(0)</code> message reporting a minefield cannot be confirmed anymore.</td>
</tr>
</tbody>
</table>
<h4 id="composite-areas-and-structures">5.4.2.5 Composite Areas and Structures</h4>
<p>A composite area is a single area specified by multiple messages. A composite structure is a single structure specified by multiple messages. Composite areas and structures may be used, for example, when an area/structure is larger than the <code>ObjectSize</code> fields allows, or to create areas/structures with shapes other than the <code>ObjectType</code> field allows.</p>
<p>To report a new composite area or structure, the first message must have its Reference Indicator set to <code>0</code> (original message), and any following message in the sequence must reference the original message using Reference Indicator <code>3</code>. The referencing messages must have the same Subject Code as the original message.</p>
<p>For example, a single mine field comprised of three area parts is reported on the network with the following message sequence:</p>
<p><code>D21(0) &lt; D21(3) &lt;&lt; D21(3)</code></p>
<p>Composite areas may only be created using messages with Object Code <code>20</code>-<code>29</code>. Composite structures may only be created using messages with Object Code <code>30</code>-<code>39</code>.</p>
<p>To reference a composite area or structure as a whole (e.g. to discontinue it using Reference Code <code>4</code> or to confirm it using Reference Code <code>6</code>), the referencing message must reference the original message.</p>
<p>An update message (Reference Code <code>2</code>) may reference individual messages of the sequence, and thus updating each part of the composite area/structure separately. A recall message (Reference Code <code>1</code>) may either reference the original message, or individual messages of the sequence.</p>
<h4 id="acknowledging-messages">5.4.2.6 Acknowledging messages</h4>
<p>Acknowledgements may be sent to inform others of having 'received' a certain message, i.e. to acknowledge that a certain message has been witnessed, e.g. to notify the receipt of updated information or a rejection. Acknowledgements may refer to an original, updated, related, comply or reject message and can be used in message sequences.</p>
<table>
<colgroup>
<col width="34%" />
<col width="65%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Message Sequence</th>
<th align="left">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>D21(0)X &lt; D21(2)X &lt; D21(7)Y</code></td>
<td align="left">An acknowledging message <code>D21(7)</code> referring to a <code>D21(2)</code> update message, means that the update to <code>D21(0)</code> message has been acknowledged.</td>
</tr>
<tr class="even">
<td align="left"><code>Q20(0)X &lt; Q20(9)Y &lt; Q20(7)X</code></td>
<td align="left">An Area Access request signal 'Q20(0)' is rejected by a Q20(9) message, which is then acknowledged by an Q20(7) message</td>
</tr>
</tbody>
</table>
<h4 id="complying-to-messages">5.4.2.7 Complying to messages</h4>
<p>The 'comply' message reference code provides the option to an originator to indicate they will act upon or in accordance with an original, updated, or a related message from another originator. This referencing option may be useful to respond to other originators' message to inform or notify them about an action to be undertaken.</p>
<table>
<colgroup>
<col width="34%" />
<col width="65%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Message Sequence</th>
<th align="left">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>E11(0)X &lt; E11(8)Y</code></td>
<td align="left">An Emergency Signal <code>E11(0)</code> indicating that urgent medical assistance is required, is responded to by somebody complying with the ask for assistance.</td>
</tr>
<tr class="even">
<td align="left"><code>P02(0)X &lt; P02(8)Y &lt;&lt; P02(8)Z</code></td>
<td align="left">A request for negotiation <code>P02(0)</code> will be complied to by two different originators respectively sending a <code>P02(8)</code> message.</td>
</tr>
</tbody>
</table>
<h4 id="rejecting-messages">5.4.2.8 Rejecting messages</h4>
<p>The 'reject' message reference code may be used to indicate that the originator rejects, denies or does not agree with the referred original, updated, or a related message from another originator.</p>
<table>
<colgroup>
<col width="34%" />
<col width="65%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Message Sequence</th>
<th align="left">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>Q20(0)X &lt; Q20(9)Y</code></td>
<td align="left">An Area Access request signal 'Q20(0)' is rejected by a Q20(9) message</td>
</tr>
<tr class="even">
<td align="left"><code>D21(0)X &lt; D21(9)Y</code></td>
<td align="left">An original message reporting a minefield is rejected by a different originators with a <code>D21(9)</code> messages referring to the original <code>D21(0)</code>.</td>
</tr>
</tbody>
</table>
<h2 id="testing">5.5 Testing</h2>
<p>Test messages must be disregarded for any other purposes than testing. Test messages should only be used on testing networks of blockchains.</p>
<p>A test message may reference any other message for testing purposes.</p>
<h1 id="annex-a.-blockchain-layer-specific-details">Annex A. Blockchain layer specific details</h1>
<p>This Annex is meant to provide additional information and considerations about the use of blockchain networks for Whiteflag Protocol end-users and for creating implementations.</p>
<h2 id="a.1-implementation-guidelines">A.1 Implementation Guidelines</h2>
<h3 id="a.1.1-completeness-of-the-blockchain-database">A.1.1 Completeness of the blockchain database</h3>
<p>When using the Whiteflag Network as a source for improving situational awareness, it is important for end-users to have a complete view on all messages that have been sent in a given context. It is advised for end-users to assess if all (relevant) blocks have been processed and no message has been omitted or skipped, as this might result in inaccurate interpretation of information.</p>
<h3 id="a.1.2-data-encapsulation-in-transactions">A.1.2 Data encapsulation in transactions</h3>
<p>The Whiteflag Network is created as a blockchain overlay network by Whiteflag applications embedding Whiteflag messages in blockchain transactions. The underlying blockchain network(s) therefore need(s) to allow for the encapsulating of data in a transaction.</p>
<p>For security reasons, it is currently advised to implement the Whiteflag Protocol only on blockchain networks that use a proof-of-work consensus model.</p>
<p>There exist multiple blockchain networks that provide this functionality. See the table below for several examples:</p>
<table>
<colgroup>
<col width="12%" />
<col width="18%" />
<col width="23%" />
<col width="20%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Blockchain</th>
<th align="left">Message embedding</th>
<th align="left">Maximum message length</th>
<th align="left">Signature algorithm</th>
<th align="left">Transaction hash</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bitcoin</td>
<td align="left"><code>OP_RETURN</code></td>
<td align="left">80 bytes</td>
<td align="left">ECDSA secp256k1</td>
<td align="left">256 bits (64 hexadecimals)</td>
</tr>
<tr class="even">
<td align="left">Ethereum</td>
<td align="left"><code>data</code> field</td>
<td align="left">(dynamic)</td>
<td align="left">ECDSA secp256k1</td>
<td align="left">256 bits (64 hexadecimals)</td>
</tr>
</tbody>
</table>
<p>In the case of Bitcoin, the <code>OP_RETURN</code> field of a raw transaction allows for the encapsulation of data constrained to a maximum 80 bytes.</p>
<p>In the case of Ethereum, the <code>data</code> field of a raw transaction allows for the encapsulation of a dynamic amount of data that is relative to the <code>gasLimit</code> of individual blocks. In practice, this field can generally store multiple kilobytes of data.</p>
<p>Message formatting within the Whiteflag Protocol has been structured to not require more than 80 bytes for sending signs and signals. Reference messages and/or concatenation may be used in cases where providing additional data is required.</p>
<p>Please note that the above parameters may change over time as the codebases of blockchain networks evolve, in which case implementations of the Whiteflag Protocol may need to be updated accordingly.</p>
<h3 id="a.1.3.-monitoring-of-dynamic-blockchain-parameters">A.1.3. Monitoring of Dynamic Blockchain Parameters</h3>
<p>Blockchain networks are highly dynamic distributed computing networks that, because of their decentralized architecture, rely both on actively and continuously maintained consensus by its participating validating nodes, as well as on the peer-to-peer infrastructure for transceiving data over the network.</p>
<p>It is advisable to monitor several parameters when implementing the Whiteflag Protocol to ensure the underlying blockchain network(s) is/are operating correctly.</p>
<h4 id="a.1.3.1-relaying-and-processing-of-messages">A.1.3.1 Relaying and Processing of Messages</h4>
<p>The following parameters concern the relaying and processing of Whiteflag messages by the underlying blockchain network(s).</p>
<h5 id="peer-to-peer-connectivity">Peer-to-Peer Connectivity</h5>
<p>Monitoring of the amount of peers a message sending Whiteflag account connects to, to ensure messages are relayed correctly. Many blockchain networks provide a list of nodes that have proven long-term reliability. It is up to the Whiteflag participant to decide how many and which peers to connect to.</p>
<h5 id="transaction-costs">Transaction Costs</h5>
<p>Each message will inflict a minimal Transaction Cost to be paid for the network to process the transaction. These costs usually consist of a minimum transaction amount and a transaction fee. End-users need to ensure the proper amount of funds are included for each message that is sent.</p>
<h5 id="block-time">Block Time</h5>
<p>Each blockchain networks' consensus protocol defines an average Block Time the network targets for creating new blocks. Monitoring of block creation time can assist in determining the expected validation time of a message.</p>
<h5 id="transaction-relay-time">Transaction Relay Time</h5>
<p>Monitoring of the number of transactions on the blockchain network pending verification. In cases of very high transactional load, transactions may require longer processing times or increased fees.</p>
<h5 id="number-of-block-confirmations">Number of Block Confirmations</h5>
<p>Monitoring the number of blocks that have been added to the shared database <em>after</em> the block containing a Whiteflag message. It is up to the Whiteflag participant to determine how many blocks <em>deep</em> a message needs to be for it to be considered secured in the blockchain.</p>
<h5 id="blockchain-protocol-changes">Blockchain Protocol Changes</h5>
<p>Blockchain networks rely on their respective protocols for verifying transactions on the network. In case of a change in protocol, features may change causing Whiteflag Protocol implementations to require updating.</p>
<h4 id="a.1.3.2-blockchain-security">A.1.3.2 Blockchain Security</h4>
<p>The following parameters concern the security of the underlying blockchain network(s):</p>
<h5 id="network-hash-rate">Network hash-rate</h5>
<p>Monitoring of the aggregated computational power of the number of transaction validating nodes.</p>
<h5 id="changes-in-network-hash-rate">Changes in Network Hash-Rate</h5>
<p>Monitoring whether there are significant changes in the network's hash-rate and if so, take appropriate measures.</p>
<h5 id="hash-rate-distribution">Hash-Rate Distribution</h5>
<p>Monitoring the distribution of the total hash-rate amongst the participating validating nodes. In case of a validating node (or a collection of nodes) representing 51% of the total network hash-rate, take appropriate measures.</p>
<h5 id="consensus-protocol-changes">Consensus Protocol Changes</h5>
<p>Blockchain networks rely on their respective consensus protocols for the proper validation of transactions. Major changes to a consensus protocol may have significant impact to a blockchain network as a whole.</p>
<h5 id="chain-reorganisation-dynamics">Chain Reorganisation Dynamics</h5>
<p>Malicious actors may perform attacks on a blockchain network by causing rapid and/or large-scale chain reorganisations. Many blockchain network prescribe a chain &quot;re-org limit&quot; and have implemented other measures to mitigate such events. It is advised to assess resiliency to such attacks per individual blockchain network.</p>
<h2 id="a.2.-general-considerations-related-to-blockchain-network-functionality">A.2. General considerations related to blockchain network functionality</h2>
<h3 id="a.2.1-consensus-protocols">A.2.1 Consensus protocols</h3>
<p>Blockchain networks using the proof-of-work consensus model (Nakamoto consensus) timestamp transactions by hashing them into an ongoing chain of hash-based proof-of-work, forming a record that cannot be changed without redoing the proof-of-work. The timestamp proves that the data must have existed at the time in order to get into the hash. Each timestamp includes the previous timestamp in its hash, forming a chain, with each additional timestamp reinforcing the ones before it. The hash chain of blocks provides an unchangeable historical record, which is verifiable by anyone.</p>
<p>Blockchain networks using different consensus protocols are currently in an experimental phase and have not yet been proven to work securely at large scale. At this point, it is therefore not advised to use an other type of blockchain network than those using a proof-of-work consensus protocol.</p>
<h3 id="a.2.2-market-dynamics">A.2.2 Market dynamics</h3>
<p>Blockchain networks require a native currency (often called crypto-currency) to incentivize validating nodes to expend resources on doing the proof-of-work. Transactions containing Whiteflag messages are sent by spending only the minimum amount of native currency required by the blockchain network's protocol to effect a valid transaction, plus an additional fee.</p>
<p>While these amounts may be relatively small, the market dynamics related to these native currencies can cause price volatility, bear/bull dynamics or even trade-halts, which may cause effect usability.</p>
<h3 id="a.2.3-private-blockchain-networks-and-permissioned-distributed-ledgers">A.2.3 Private Blockchain Networks and Permissioned Distributed Ledgers</h3>
<p>Please note that the Whiteflag Protocol is specifically designed to be implemented on open blockchain networks. Private blockchain networks, or permissioned distributed ledgers, do not adhere to the design principles of the Whiteflag Network, as these systems require a trusted party (i.e. trusted nodes) to establish consensus within the network and do not provide open access, and should therefore not be used.</p>
<h3 id="a.2.4-anonymous-transactions">A.2.4 Anonymous Transactions</h3>
<p>Blockchain networks using digital signature schemes that enable fully anonymous transactions could theoretically be used to anonymously send messages on the Whiteflag Network. Examples of such blockchains employ techniques like zero-knowledge-proofs and ring signatures to create conditions of untraceability and unlinkability. These type of transactions do not adhere to the principles of this standard, as they limit message authentication, and should therefore not be used.</p>
<h1 id="annex-b.-json-schema-of-whiteflag-messages">Annex B. JSON Schema of Whiteflag Messages</h1>
<p>(<em>contained in separate file</em>)</p>
<h1 id="annex-c.-example-json-authentication-objects">Annex C. Example JSON Authentication Objects</h1>
<p>The JSON representation of an <code>A1</code> message sent using an example static Base58 blockchain address <code>1C8KSK68SJjfDSBx9BpSx3qB3bePf23r77</code> may be as follows:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
    <span class="dt">&quot;MetaHeader&quot;</span><span class="fu">:</span> <span class="fu">{</span>
        <span class="dt">&quot;example&quot;</span><span class="fu">:</span> <span class="kw">true</span>
    <span class="fu">},</span>
    <span class="dt">&quot;MessageHeader&quot;</span><span class="fu">:</span> <span class="fu">{</span>
        <span class="dt">&quot;Prefix&quot;</span><span class="fu">:</span> <span class="st">&quot;WF&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;Version&quot;</span><span class="fu">:</span> <span class="st">&quot;1&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;EncryptionIndicator&quot;</span><span class="fu">:</span> <span class="st">&quot;0&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;DuressIndicator&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span>
        <span class="dt">&quot;MessageCode&quot;</span><span class="fu">:</span> <span class="st">&quot;A&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;ReferenceIndicator&quot;</span><span class="fu">:</span> <span class="st">&quot;0&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;ReferencedMessage&quot;</span><span class="fu">:</span> <span class="st">&quot;0000000000000000000000000000000000000000000000000000000000000000&quot;</span>
    <span class="fu">},</span>
    <span class="dt">&quot;MessageBody&quot;</span><span class="fu">:</span> <span class="fu">{</span>
        <span class="dt">&quot;VerificationMethod&quot;</span><span class="fu">:</span> <span class="st">&quot;1&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;VerificationData&quot;</span><span class="fu">:</span> <span class="st">&quot;https://organisation.int/whiteflag&quot;</span>
    <span class="fu">}</span>
<span class="fu">}</span></code></pre></div>
<p>The related JSON formatted object with the authentication information to be signed and published at the provided URL <code>https://organisation.int/whiteflag</code> would be:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
    <span class="dt">&quot;addr&quot;</span><span class="fu">:</span> <span class="st">&quot;1C8KSK68SJjfDSBx9BpSx3qB3bePf23r77&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;orgname&quot;</span><span class="fu">:</span> <span class="st">&quot;Organisation Name&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;url&quot;</span><span class="fu">:</span> <span class="st">&quot;https://organisation.int/whiteflag&quot;</span>
<span class="fu">}</span></code></pre></div>
<p>This object is then used as the payload to create a JSON Web Signature (JWS) object that includes a digital signature created with the private key of the Bitcoin address. The compact serialization specified by the JWS standard would normally result in the following token:</p>
<pre class="jwt"><code>eyJhbGciOiJFUzI1NiJ9.eeyJhZGRyIjoiMUM4S1NLNjhTSmpmRFNCeDlCcFN4M3FCM2JlUGYyM3I3N
yIsIm9yZ25hbWUiOiJPcmdhbmlzYXRpb24gTmFtZSIsInVybCI6Imh0dHBzOi8vb3JnYW5pc2F0aW9u
LmludC93aGl0ZWZsYWcifQo.XWBRA1TrCxs8tpep1lLPcmpp9JlO_A0TJB5ULOROvadje3SgAsfkFEj
E2DoHGpWJ_zNGlEPBtdUQo9MEypIp2Q</code></pre>
<p>However, for practical purposes the object published at the provided URL must be a flattened JWS JSON Serialization object:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
    <span class="dt">&quot;protected&quot;</span><span class="fu">:</span> <span class="st">&quot;eyJhbGciOiJFUzI1NiJ9&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;payload&quot;</span><span class="fu">:</span> <span class="st">&quot;eeyJhZGRyIjoiMUM4S1NLNjhTSmpmRFNCeDlCcFN4M3FCM2JlUGYyM3I3NyIsIm</span>
<span class="st">                9yZ25hbWUiOiJPcmdhbmlzYXRpb24gTmFtZSIsInVybCI6Imh0dHBzOi8vb3JnY</span>
<span class="st">                W5pc2F0aW9uLmludC93aGl0ZWZsYWcifQo&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;signature&quot;</span><span class="fu">:</span> <span class="st">&quot;XWBRA1TrCxs8tpep1lLPcmpp9JlO_A0TJB5ULOROvadje3SgAsfkFEjE2DoHG</span>
<span class="st">                  pWJ_zNGlEPBtdUQo9MEypIp2Q&quot;</span>
<span class="fu">}</span></code></pre></div>
<p>The equivalent of a fully unserialized JSON object representation is provided here as human readable example:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
    <span class="dt">&quot;protected&quot;</span><span class="fu">:</span> <span class="fu">{</span>
        <span class="dt">&quot;alg&quot;</span><span class="fu">:</span> <span class="st">&quot;ES256&quot;</span>
    <span class="fu">},</span>
    <span class="dt">&quot;payload&quot;</span><span class="fu">:</span> <span class="fu">{</span>
        <span class="dt">&quot;addr&quot;</span><span class="fu">:</span> <span class="st">&quot;1C8KSK68SJjfDSBx9BpSx3qB3bePf23r77&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;orgname&quot;</span><span class="fu">:</span> <span class="st">&quot;Organisation Name&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;url&quot;</span><span class="fu">:</span> <span class="st">&quot;https://organisation.int/whiteflag&quot;</span>
    <span class="fu">},</span>
    <span class="dt">&quot;signature&quot;</span><span class="fu">:</span> <span class="st">&quot;XWBRA1TrCxs8tpep1lLPcmpp9JlO_A0TJB5ULOROvadje3SgAsfkFEjE2DoHG</span>
<span class="st">                  pWJ_zNGlEPBtdUQo9MEypIp2Q&quot;</span>
<span class="fu">}</span></code></pre></div>
<p>Note that the used algorithm (ES256, i.e. ECDSA using P-256 and SHA-256, in line with the underlying blockchain) is included in the protected header.</p>
<h1 id="annex-d.-definitions">Annex D. Definitions</h1>
<p>Below is an overview of terms as used in this standard within the context of Whiteflag.</p>
<table>
<colgroup>
<col width="17%" />
<col width="82%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Term</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Account</td>
<td align="left">The identifier under which an <em>originator</em> utilises one or more blockchain <em>addresses</em>.</td>
</tr>
<tr class="even">
<td align="left">Address</td>
<td align="left">The identifier that corresponds to a cryptographic key pair to perform <em>transactions</em>, i.e. to send <em>messages</em>, on a <em>blockchain</em>.</td>
</tr>
<tr class="odd">
<td align="left">Application</td>
<td align="left">Any software, system or device utilising (part of) the Whiteflag Protocol.</td>
</tr>
<tr class="even">
<td align="left">Authentication</td>
<td align="left">The confirmation that a claimed characteristic of an entity is actually correct, in this case used to verify the <em>originator</em> of a <em>message</em>.</td>
</tr>
<tr class="odd">
<td align="left">Blockchain</td>
<td align="left">A distributed and continuously growing list of grouped <em>transactions</em>, called blocks, which are linked and secured using cryptography.</td>
</tr>
<tr class="even">
<td align="left">Confidentiality</td>
<td align="left">The assurance that the information contained in a <em>message</em> is not made available or disclosed to entities as required by the originator.</td>
</tr>
<tr class="odd">
<td align="left">Data Integrity</td>
<td align="left">Verification that the information contained in a <em>message</em> is received completely and unaltered.</td>
</tr>
<tr class="even">
<td align="left">Disaster</td>
<td align="left">A sudden, calamitous event that seriously disrupts the functioning of a community or society and causes human, material, and economic or environmental losses that exceed the community's or society's ability to cope using its own resources.</td>
</tr>
<tr class="odd">
<td align="left">Message</td>
<td align="left">An atomic piece of Whiteflag data as defined in this standard and incorporated in a single <em>transaction</em> on a <em>blockchain</em>.</td>
</tr>
<tr class="even">
<td align="left">Network</td>
<td align="left">The usage of the Whiteflag protocol on a specific <em>blockchain</em>, or all Whiteflag <em>participants</em> on a specific <em>blockchain</em>.</td>
</tr>
<tr class="odd">
<td align="left">Non-repudiation</td>
<td align="left">The undeniable proof that a <em>message</em> has been sent by an <em>address</em>.</td>
</tr>
<tr class="even">
<td align="left">Open Standard</td>
<td align="left">A standard that is public and without any restriction in their access or implementation.</td>
</tr>
<tr class="odd">
<td align="left">Originator</td>
<td align="left">A <em>participant</em> that is the sender of a <em>message</em>.</td>
</tr>
<tr class="even">
<td align="left">Participant</td>
<td align="left">A person or an organisation using the Whiteflag protocol; a participant may have multiple <em>blockchain</em> <em>accounts</em>.</td>
</tr>
<tr class="odd">
<td align="left">Protective Sign</td>
<td align="left">A symbol used to mark persons and objects under the protection of treaties international law and regulations.</td>
</tr>
<tr class="even">
<td align="left">Security</td>
<td align="left">The measures to protect and preserve the <em>integrity</em> and <em>availability</em> of the messages, and, if required by the <em>originator</em>, the <em>confidentiality</em>.</td>
</tr>
<tr class="odd">
<td align="left">Transaction</td>
<td align="left">A record on a <em>blockchain</em> (containing a single Whiteflag <em>message</em>).</td>
</tr>
</tbody>
</table>
<h1 id="annex-e.-signs-signals-equivalents">Annex E. Signs &amp; Signals Equivalents</h1>
<p>(<em>contained in separate repository</em>)</p>
<h1 id="annex-f.-example-use-cases">Annex F. Example Use Cases</h1>
<h2 id="use-case-1-ngo-area-access-to-provide-aid">Use case 1: NGO Area Access to Provide Aid</h2>
<p>A humanitarian convoy is carrying emergency assistance for affected populations in a conflict zone. First of all, the authenticity of the blockchain account of the aid organisation is validated with an <code>A2(0)</code> message and can be reinforced on a regular basis with <code>A2(2)</code> updates.</p>
<p>In order to safely reach their destination, the aid organisation needs to request area access in advance to all parties to the conflict. These requests are made using <code>Q</code> messages, with which the following information is provided: trajectory, dates, vehicles and personnel. The aid organisation is able to send these request encrypted to each party individually by generating a unique encryption key for that party using the <code>K0A</code> messages on the blockchain.</p>
<p>Parties can indicate the receipt and compliance with the request by using reference codes <code>7</code> and <code>8</code>. Last but not least, a party may withdraw its compliance with the request at any time by sending a Q(9) deny message. This would result in the following sequence:</p>
<p><code>Q20(0)A &lt; Q20(3)A ... &lt;&lt; Q(7) &lt;&lt;&lt; Q(8) ... &lt;&lt;&lt;&lt; Q(9)</code></p>
<p>While on the road, the convoy is able to quickly inform other humanitarian actors of potential changes in the environment as well as receive as much as possible live information while driving, by using protection and danger signs, e.g. the <code>P11</code> protective sign, <code>D13</code> bomb attack, <code>D21</code> unexploded ordnance, <code>DA5</code> bomb attacks, <code>D51</code> uncontrolled uprising, etc.</p>
<p>Once on location, a protective sign is sent. In order to achieve meaningful humanitarian action, the NGO also communicates the type of assistance provided using <code>M</code> messages to avoid duplication and inefficiency of humanitarian aid:</p>
<p><code>P11(5) &lt; M(5)</code></p>
<h2 id="use-case-2-protected-sites-and-critical-infrastructures">Use case 2: Protected Sites and Critical Infrastructures</h2>
<p>Since messages are persistent on a blockchain, an organisation can utilize the Whiteflag Protocol to create a public digital register of sites that are protected under international law using <code>P</code> messages. In addition, <code>I</code> messages are used for notifications about infrastructures that are not necessarily protected under international law, but are important for NGO operations or for affected populations and refugees: e.g. water treatment facilities, power plants, food distribution location, shelter, NGO warehouses, using <code>I</code> messages.</p>
<p>This information might be shared to prevent unintended air attacks, but also to share information between NGOs and the UN. For example, an NGO maintains a continuously updated overview of critical infrastructures and a register of hospitals on the Whiteflag network, including status updates. It is an operational decision to disclose or encrypt the information to prevent abuse.</p>
<p>Currently, this type of information is not always confirmed or denied afterwards. Using Whiteflag, other parties can confirm the information by using reference code 6, e.g.:</p>
<p><code>I(0) &lt; I(6) ... P31(0) &lt; P31(6)</code></p>
<p>A message sequence where a hospital is identified, a party indicates it will comply with its protected status, and the status of the hospital is periodically updated, will look like:</p>
<p><code>P31(0) &lt; P31(8) &lt;&lt; S(5) ... &lt; S(2)</code></p>
<p>Another example is a local cultural institute C that can create a public digital register of monuments in its city or village by posting a protective sign at each monuments location, using <code>P52</code> messages (protective sign for a cultural property).</p>
<p>When a protected site or critical infrastructure ever comes under attack, this can be broadcasted immediately by anyone using the Whiteflag Protocol, sending for example a <code>D11</code> message (structure under ground attack), resulting in the following message sequence:</p>
<p><code>P52(0)C &lt; D11(5)</code></p>
<p>Were the attack undertaken by a party that intends to comply with international law (for which reason such a party might very well actively use the Whiteflag Protocol), that party would be immediately informed of their mistake allowing them to cease fire before any more damage is done.</p>
<p>If the attack is performed by a non-compliant armed group, the Whiteflag Protocol ensures that the attack is recorded and known to the international community, allowing for example peacekeeping forces to react and/or providing evidence for the war crime.</p>
<h2 id="use-case-3-peacekeeping-forces-confirm-a-mine-field-reported-by-locals">Use case 3: Peacekeeping Forces Confirm a Mine Field Reported by Locals</h2>
<p>The Whiteflag Protocol allows to digitally mark dangerous zones, such as minefields or areas where unexploded ammunition is present. Suppose local civilians are aware of an area where mines are present. A local aid worker A might report such an area by sending one or more <code>D21</code> messages using a special app on her smartphone. The information about the dangerous area is available immediately to civilians, NGOs, journalists etc., even though the information about the mine field might not yet considered accurate or true by everybody.</p>
<p>Based on the original message, a UN peacekeeping unit or UNMAS (U) plan to investigate the area. Once they can confirm it is a minefield, a higher-level UN headquarters sends a confirmation message using a UN information system with a Whiteflag interface through a well-known and validated UN blockchain account.</p>
<p>A link to an UNMAS website with additional information (mine types, quantity, level of danger, stay clear area, current de-mining status) is provided using an <code>R</code> message, which can be resent when the web page is updated.</p>
<p>This scenario resulted in the following message sequence:</p>
<p><code>D21(0)A &lt; D21(6)U &lt; R(3)U ... &lt; R(2)U</code></p>
<p>It would be very easy for anyone to develop a web application to actively monitor all these sorts of messages and project this information on a map, creating broad awareness of the danger among aid workers and local populations.</p>
<h2 id="use-case-4-proof-of-life-by-a-journalist">Use case 4: Proof of Life by a Journalist</h2>
<p>A journalist working in a combat zone wants to let his news agency know where he is on a regular basis. To do this, the journalist makes his blockchain account known by sending an <code>A2</code> message containing a token that was provided to him by his news agency. He can now be positively identified on the network by his news agency, while his identity is not made public.</p>
<p>From now on, the journalist can send an <code>S11</code> (proof-of-life status message) on a regular basis, either with or without his location. For extra security, it is possible to encrypt the message to ensure only recipients know where he is.</p>
<h2 id="use-case-5-negotiate-a-cease-fire-between-fighting-parties">Use case 5: Negotiate a Cease Fire between Fighting Parties</h2>
<p>Warring parties can use Whiteflag to negotiate a cease fire, e.g. to be able to provide medical care in a specific area for a certain amount of time. In the following example sequence, party A requests a cease fire using a <code>Q</code> message with additional information included in an <code>F</code> message; parties B and C agree with the request by responding with reference code <code>8</code>:</p>
<p><code>Q(0)A &lt; F(3)A &lt;&lt; Q(8)B &lt;&lt;&lt; Q(8)C</code></p>
<p>Note that Whiteflag is limited to fixed messages and in itself not suitable to conduct detailed negotiations. However, even though other communication channels are used to come to a cease fire, Whiteflag allows to undeniably record the request and any outcomes.</p>
<h2 id="use-case-6-armed-group-under-air-attack-wants-to-surrender">Use case 6: Armed Group under Air Attack wants to Surrender</h2>
<p>Imagine an armed group A is under a heavy air attack, and the remaining combatants want to surrender. However, it is very unlikely that they are in radio contact with the pilots, and the pilots might not see a physical white flag.</p>
<p>The Whiteflag Protocol can be used to send a message to the attacking party, without knowing any contact details. An <code>A2(0)</code> message is sent, or has been sent before, referring to some sort of social media channel that is known to be used by the armed group. The blockchain account is now linked to this group, and a <code>P03(0)</code> surrender message is sent.</p>
<p>If a headquarters or command centre of the attacking party M is listening on the Whiteflag Network for situational awareness, they will be instantaneously informed of the digital white flag on the location under attack. Of course, the trustworthiness of the message needs to be evaluated based on earlier communications from the same account, other intelligence, confirmation by other parties on the network, the actual behaviour of the armed group at the location, etc.</p>
<p>Either way, the information can be relayed over a military data link to the pilots in the aircraft, who might then be able to visually confirm a white flag. Once that is the case, the attacking party M can send both a confirmation and an acknowledgement. This scenario resulted in the following message sequence:</p>
<p><code>A2(0)A &lt; P03(0)A &lt; P03(6)M &lt;&lt; P03(7)M</code></p>
</body>
</html>
